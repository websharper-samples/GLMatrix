function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
/**
 * @fileoverview gl-matrix - High performance matrix and vector operations
 * @author Brandon Jones
 * @author Colin MacKenzie IV
 * @version 2.2.0
 */
/* Copyright (c) 2013, Brandon Jones, Colin MacKenzie IV. All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

  * Redistributions of source code must retain the above copyright notice, this
    list of conditions and the following disclaimer.
  * Redistributions in binary form must reproduce the above copyright notice,
    this list of conditions and the following disclaimer in the documentation 
    and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE 
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. */
(function(e){"use strict";var t={};typeof exports=="undefined"?typeof define=="function"&&typeof define.amd=="object"&&define.amd?(t.exports={},define(function(){return t.exports})):t.exports=typeof window!="undefined"?window:e:t.exports=exports,function(e){if(!t)var t=1e-6;if(!n)var n=typeof Float32Array!="undefined"?Float32Array:Array;if(!r)var r=Math.random;var i={};i.setMatrixArrayType=function(e){n=e},typeof e!="undefined"&&(e.glMatrix=i);var s={};s.create=function(){var e=new n(2);return e[0]=0,e[1]=0,e},s.clone=function(e){var t=new n(2);return t[0]=e[0],t[1]=e[1],t},s.fromValues=function(e,t){var r=new n(2);return r[0]=e,r[1]=t,r},s.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},s.set=function(e,t,n){return e[0]=t,e[1]=n,e},s.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},s.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},s.sub=s.subtract,s.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},s.mul=s.multiply,s.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},s.div=s.divide,s.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e},s.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e},s.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},s.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e},s.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},s.dist=s.distance,s.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r},s.sqrDist=s.squaredDistance,s.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},s.len=s.length,s.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},s.sqrLen=s.squaredLength,s.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},s.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},s.cross=function(e,t,n){var r=t[0]*n[1]-t[1]*n[0];return e[0]=e[1]=0,e[2]=r,e},s.lerp=function(e,t,n,r){var i=t[0],s=t[1];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e},s.random=function(e,t){t=t||1;var n=r()*2*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},s.transformMat2=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i,e[1]=n[1]*r+n[3]*i,e},s.transformMat2d=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[2]*i+n[4],e[1]=n[1]*r+n[3]*i+n[5],e},s.transformMat3=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[3]*i+n[6],e[1]=n[1]*r+n[4]*i+n[7],e},s.transformMat4=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e},s.forEach=function(){var e=s.create();return function(t,n,r,i,s,o){var u,a;n||(n=2),r||(r=0),i?a=Math.min(i*n+r,t.length):a=t.length;for(u=r;u<a;u+=n)e[0]=t[u],e[1]=t[u+1],s(e,e,o),t[u]=e[0],t[u+1]=e[1];return t}}(),s.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},typeof e!="undefined"&&(e.vec2=s);var o={};o.create=function(){var e=new n(3);return e[0]=0,e[1]=0,e[2]=0,e},o.clone=function(e){var t=new n(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.fromValues=function(e,t,r){var i=new n(3);return i[0]=e,i[1]=t,i[2]=r,i},o.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},o.set=function(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e},o.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e},o.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e},o.sub=o.subtract,o.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e},o.mul=o.multiply,o.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e},o.div=o.divide,o.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e},o.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e},o.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e},o.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e},o.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)},o.dist=o.distance,o.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i},o.sqrDist=o.squaredDistance,o.length=function(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)},o.len=o.length,o.squaredLength=function(e){var t=e[0],n=e[1],r=e[2];return t*t+n*n+r*r},o.sqrLen=o.squaredLength,o.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},o.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s),e},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.cross=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=n[0],u=n[1],a=n[2];return e[0]=i*a-s*u,e[1]=s*o-r*a,e[2]=r*u-i*o,e},o.lerp=function(e,t,n,r){var i=t[0],s=t[1],o=t[2];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=o+r*(n[2]-o),e},o.random=function(e,t){t=t||1;var n=r()*2*Math.PI,i=r()*2-1,s=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(n)*s,e[1]=Math.sin(n)*s,e[2]=i*t,e},o.transformMat4=function(e,t,n){var r=t[0],i=t[1],s=t[2];return e[0]=n[0]*r+n[4]*i+n[8]*s+n[12],e[1]=n[1]*r+n[5]*i+n[9]*s+n[13],e[2]=n[2]*r+n[6]*i+n[10]*s+n[14],e},o.transformMat3=function(e,t,n){var r=t[0],i=t[1],s=t[2];return e[0]=r*n[0]+i*n[3]+s*n[6],e[1]=r*n[1]+i*n[4]+s*n[7],e[2]=r*n[2]+i*n[5]+s*n[8],e},o.transformQuat=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=n[0],u=n[1],a=n[2],f=n[3],l=f*r+u*s-a*i,c=f*i+a*r-o*s,h=f*s+o*i-u*r,p=-o*r-u*i-a*s;return e[0]=l*f+p*-o+c*-a-h*-u,e[1]=c*f+p*-u+h*-o-l*-a,e[2]=h*f+p*-a+l*-u-c*-o,e},o.forEach=function(){var e=o.create();return function(t,n,r,i,s,o){var u,a;n||(n=3),r||(r=0),i?a=Math.min(i*n+r,t.length):a=t.length;for(u=r;u<a;u+=n)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],s(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2];return t}}(),o.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},typeof e!="undefined"&&(e.vec3=o);var u={};u.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},u.clone=function(e){var t=new n(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},u.fromValues=function(e,t,r,i){var s=new n(4);return s[0]=e,s[1]=t,s[2]=r,s[3]=i,s},u.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},u.set=function(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e},u.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e},u.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e},u.sub=u.subtract,u.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e},u.mul=u.multiply,u.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e},u.div=u.divide,u.min=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e},u.max=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e},u.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e},u.scaleAndAdd=function(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e},u.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return Math.sqrt(n*n+r*r+i*i+s*s)},u.dist=u.distance,u.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2],s=t[3]-e[3];return n*n+r*r+i*i+s*s},u.sqrDist=u.squaredDistance,u.length=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return Math.sqrt(t*t+n*n+r*r+i*i)},u.len=u.length,u.squaredLength=function(e){var t=e[0],n=e[1],r=e[2],i=e[3];return t*t+n*n+r*r+i*i},u.sqrLen=u.squaredLength,u.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},u.normalize=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o),e},u.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},u.lerp=function(e,t,n,r){var i=t[0],s=t[1],o=t[2],u=t[3];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e[2]=o+r*(n[2]-o),e[3]=u+r*(n[3]-u),e},u.random=function(e,t){return t=t||1,e[0]=r(),e[1]=r(),e[2]=r(),e[3]=r(),u.normalize(e,e),u.scale(e,e,t),e},u.transformMat4=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,e},u.transformQuat=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=n[0],u=n[1],a=n[2],f=n[3],l=f*r+u*s-a*i,c=f*i+a*r-o*s,h=f*s+o*i-u*r,p=-o*r-u*i-a*s;return e[0]=l*f+p*-o+c*-a-h*-u,e[1]=c*f+p*-u+h*-o-l*-a,e[2]=h*f+p*-a+l*-u-c*-o,e},u.forEach=function(){var e=u.create();return function(t,n,r,i,s,o){var u,a;n||(n=4),r||(r=0),i?a=Math.min(i*n+r,t.length):a=t.length;for(u=r;u<a;u+=n)e[0]=t[u],e[1]=t[u+1],e[2]=t[u+2],e[3]=t[u+3],s(e,e,o),t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];return t}}(),u.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},typeof e!="undefined"&&(e.vec4=u);var a={};a.create=function(){var e=new n(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},a.clone=function(e){var t=new n(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},a.transpose=function(e,t){if(e===t){var n=t[1];e[1]=t[2],e[2]=n}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},a.invert=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n*s-i*r;return o?(o=1/o,e[0]=s*o,e[1]=-r*o,e[2]=-i*o,e[3]=n*o,e):null},a.adjoint=function(e,t){var n=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=n,e},a.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},a.multiply=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=n[0],a=n[1],f=n[2],l=n[3];return e[0]=r*u+i*f,e[1]=r*a+i*l,e[2]=s*u+o*f,e[3]=s*a+o*l,e},a.mul=a.multiply,a.rotate=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=Math.sin(n),a=Math.cos(n);return e[0]=r*a+i*u,e[1]=r*-u+i*a,e[2]=s*a+o*u,e[3]=s*-u+o*a,e},a.scale=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=n[0],a=n[1];return e[0]=r*u,e[1]=i*a,e[2]=s*u,e[3]=o*a,e},a.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},typeof e!="undefined"&&(e.mat2=a);var f={};f.create=function(){var e=new n(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},f.clone=function(e){var t=new n(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},f.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},f.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},f.invert=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=n*s-r*i;return a?(a=1/a,e[0]=s*a,e[1]=-r*a,e[2]=-i*a,e[3]=n*a,e[4]=(i*u-s*o)*a,e[5]=(r*o-n*u)*a,e):null},f.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},f.multiply=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=n[0],l=n[1],c=n[2],h=n[3],p=n[4],d=n[5];return e[0]=r*f+i*c,e[1]=r*l+i*h,e[2]=s*f+o*c,e[3]=s*l+o*h,e[4]=f*u+c*a+p,e[5]=l*u+h*a+d,e},f.mul=f.multiply,f.rotate=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=Math.sin(n),l=Math.cos(n);return e[0]=r*l+i*f,e[1]=-r*f+i*l,e[2]=s*l+o*f,e[3]=-s*f+l*o,e[4]=l*u+f*a,e[5]=l*a-f*u,e},f.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=t[0]*r,e[1]=t[1]*i,e[2]=t[2]*r,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*i,e},f.translate=function(e,t,n){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+n[0],e[5]=t[5]+n[1],e},f.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},typeof e!="undefined"&&(e.mat2d=f);var l={};l.create=function(){var e=new n(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},l.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},l.clone=function(e){var t=new n(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},l.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},l.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},l.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},l.invert=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8],c=l*o-u*f,h=-l*s+u*a,p=f*s-o*a,d=n*c+r*h+i*p;return d?(d=1/d,e[0]=c*d,e[1]=(-l*r+i*f)*d,e[2]=(u*r-i*o)*d,e[3]=h*d,e[4]=(l*n-i*a)*d,e[5]=(-u*n+i*s)*d,e[6]=p*d,e[7]=(-f*n+r*a)*d,e[8]=(o*n-r*s)*d,e):null},l.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8];return e[0]=o*l-u*f,e[1]=i*f-r*l,e[2]=r*u-i*o,e[3]=u*a-s*l,e[4]=n*l-i*a,e[5]=i*s-n*u,e[6]=s*f-o*a,e[7]=r*a-n*f,e[8]=n*o-r*s,e},l.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8];return t*(f*s-o*a)+n*(-f*i+o*u)+r*(a*i-s*u)},l.multiply=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c=t[8],h=n[0],p=n[1],d=n[2],v=n[3],m=n[4],g=n[5],y=n[6],b=n[7],w=n[8];return e[0]=h*r+p*o+d*f,e[1]=h*i+p*u+d*l,e[2]=h*s+p*a+d*c,e[3]=v*r+m*o+g*f,e[4]=v*i+m*u+g*l,e[5]=v*s+m*a+g*c,e[6]=y*r+b*o+w*f,e[7]=y*i+b*u+w*l,e[8]=y*s+b*a+w*c,e},l.mul=l.multiply,l.translate=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c=t[8],h=n[0],p=n[1];return e[0]=r,e[1]=i,e[2]=s,e[3]=o,e[4]=u,e[5]=a,e[6]=h*r+p*o+f,e[7]=h*i+p*u+l,e[8]=h*s+p*a+c,e},l.rotate=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c=t[8],h=Math.sin(n),p=Math.cos(n);return e[0]=p*r+h*o,e[1]=p*i+h*u,e[2]=p*s+h*a,e[3]=p*o-h*r,e[4]=p*u-h*i,e[5]=p*a-h*s,e[6]=f,e[7]=l,e[8]=c,e},l.scale=function(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},l.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},l.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,c=n*a,h=r*u,p=r*a,d=i*a,v=s*o,m=s*u,g=s*a;return e[0]=1-(h+d),e[3]=l+g,e[6]=c-m,e[1]=l-g,e[4]=1-(f+d),e[7]=p+v,e[2]=c+m,e[5]=p-v,e[8]=1-(f+h),e},l.normalFromMat4=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8],c=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15],y=n*u-r*o,b=n*a-i*o,w=n*f-s*o,E=r*a-i*u,S=r*f-s*u,x=i*f-s*a,T=l*v-c*d,N=l*m-h*d,C=l*g-p*d,k=c*m-h*v,L=c*g-p*v,A=h*g-p*m,O=y*A-b*L+w*k+E*C-S*N+x*T;return O?(O=1/O,e[0]=(u*A-a*L+f*k)*O,e[1]=(a*C-o*A-f*N)*O,e[2]=(o*L-u*C+f*T)*O,e[3]=(i*L-r*A-s*k)*O,e[4]=(n*A-i*C+s*N)*O,e[5]=(r*C-n*L-s*T)*O,e[6]=(v*x-m*S+g*E)*O,e[7]=(m*w-d*x-g*b)*O,e[8]=(d*S-v*w+g*y)*O,e):null},l.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},typeof e!="undefined"&&(e.mat3=l);var c={};c.create=function(){var e=new n(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},c.clone=function(e){var t=new n(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},c.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},c.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},c.transpose=function(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],s=t[6],o=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=s,e[11]=t[14],e[12]=i,e[13]=o,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},c.invert=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8],c=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15],y=n*u-r*o,b=n*a-i*o,w=n*f-s*o,E=r*a-i*u,S=r*f-s*u,x=i*f-s*a,T=l*v-c*d,N=l*m-h*d,C=l*g-p*d,k=c*m-h*v,L=c*g-p*v,A=h*g-p*m,O=y*A-b*L+w*k+E*C-S*N+x*T;return O?(O=1/O,e[0]=(u*A-a*L+f*k)*O,e[1]=(i*L-r*A-s*k)*O,e[2]=(v*x-m*S+g*E)*O,e[3]=(h*S-c*x-p*E)*O,e[4]=(a*C-o*A-f*N)*O,e[5]=(n*A-i*C+s*N)*O,e[6]=(m*w-d*x-g*b)*O,e[7]=(l*x-h*w+p*b)*O,e[8]=(o*L-u*C+f*T)*O,e[9]=(r*C-n*L-s*T)*O,e[10]=(d*S-v*w+g*y)*O,e[11]=(c*w-l*S-p*y)*O,e[12]=(u*N-o*k-a*T)*O,e[13]=(n*k-r*N+i*T)*O,e[14]=(v*b-d*E-m*y)*O,e[15]=(l*E-c*b+h*y)*O,e):null},c.adjoint=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],u=t[5],a=t[6],f=t[7],l=t[8],c=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15];return e[0]=u*(h*g-p*m)-c*(a*g-f*m)+v*(a*p-f*h),e[1]=-(r*(h*g-p*m)-c*(i*g-s*m)+v*(i*p-s*h)),e[2]=r*(a*g-f*m)-u*(i*g-s*m)+v*(i*f-s*a),e[3]=-(r*(a*p-f*h)-u*(i*p-s*h)+c*(i*f-s*a)),e[4]=-(o*(h*g-p*m)-l*(a*g-f*m)+d*(a*p-f*h)),e[5]=n*(h*g-p*m)-l*(i*g-s*m)+d*(i*p-s*h),e[6]=-(n*(a*g-f*m)-o*(i*g-s*m)+d*(i*f-s*a)),e[7]=n*(a*p-f*h)-o*(i*p-s*h)+l*(i*f-s*a),e[8]=o*(c*g-p*v)-l*(u*g-f*v)+d*(u*p-f*c),e[9]=-(n*(c*g-p*v)-l*(r*g-s*v)+d*(r*p-s*c)),e[10]=n*(u*g-f*v)-o*(r*g-s*v)+d*(r*f-s*u),e[11]=-(n*(u*p-f*c)-o*(r*p-s*c)+l*(r*f-s*u)),e[12]=-(o*(c*m-h*v)-l*(u*m-a*v)+d*(u*h-a*c)),e[13]=n*(c*m-h*v)-l*(r*m-i*v)+d*(r*h-i*c),e[14]=-(n*(u*m-a*v)-o*(r*m-i*v)+d*(r*a-i*u)),e[15]=n*(u*h-a*c)-o*(r*h-i*c)+l*(r*a-i*u),e},c.determinant=function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=e[8],l=e[9],c=e[10],h=e[11],p=e[12],d=e[13],v=e[14],m=e[15],g=t*o-n*s,y=t*u-r*s,b=t*a-i*s,w=n*u-r*o,E=n*a-i*o,S=r*a-i*u,x=f*d-l*p,T=f*v-c*p,N=f*m-h*p,C=l*v-c*d,k=l*m-h*d,L=c*m-h*v;return g*L-y*k+b*C+w*N-E*T+S*x},c.multiply=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=t[7],c=t[8],h=t[9],p=t[10],d=t[11],v=t[12],m=t[13],g=t[14],y=t[15],b=n[0],w=n[1],E=n[2],S=n[3];return e[0]=b*r+w*u+E*c+S*v,e[1]=b*i+w*a+E*h+S*m,e[2]=b*s+w*f+E*p+S*g,e[3]=b*o+w*l+E*d+S*y,b=n[4],w=n[5],E=n[6],S=n[7],e[4]=b*r+w*u+E*c+S*v,e[5]=b*i+w*a+E*h+S*m,e[6]=b*s+w*f+E*p+S*g,e[7]=b*o+w*l+E*d+S*y,b=n[8],w=n[9],E=n[10],S=n[11],e[8]=b*r+w*u+E*c+S*v,e[9]=b*i+w*a+E*h+S*m,e[10]=b*s+w*f+E*p+S*g,e[11]=b*o+w*l+E*d+S*y,b=n[12],w=n[13],E=n[14],S=n[15],e[12]=b*r+w*u+E*c+S*v,e[13]=b*i+w*a+E*h+S*m,e[14]=b*s+w*f+E*p+S*g,e[15]=b*o+w*l+E*d+S*y,e},c.mul=c.multiply,c.translate=function(e,t,n){var r=n[0],i=n[1],s=n[2],o,u,a,f,l,c,h,p,d,v,m,g;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*s+t[12],e[13]=t[1]*r+t[5]*i+t[9]*s+t[13],e[14]=t[2]*r+t[6]*i+t[10]*s+t[14],e[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(o=t[0],u=t[1],a=t[2],f=t[3],l=t[4],c=t[5],h=t[6],p=t[7],d=t[8],v=t[9],m=t[10],g=t[11],e[0]=o,e[1]=u,e[2]=a,e[3]=f,e[4]=l,e[5]=c,e[6]=h,e[7]=p,e[8]=d,e[9]=v,e[10]=m,e[11]=g,e[12]=o*r+l*i+d*s+t[12],e[13]=u*r+c*i+v*s+t[13],e[14]=a*r+h*i+m*s+t[14],e[15]=f*r+p*i+g*s+t[15]),e},c.scale=function(e,t,n){var r=n[0],i=n[1],s=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},c.rotate=function(e,n,r,i){var s=i[0],o=i[1],u=i[2],a=Math.sqrt(s*s+o*o+u*u),f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return Math.abs(a)<t?null:(a=1/a,s*=a,o*=a,u*=a,f=Math.sin(r),l=Math.cos(r),c=1-l,h=n[0],p=n[1],d=n[2],v=n[3],m=n[4],g=n[5],y=n[6],b=n[7],w=n[8],E=n[9],S=n[10],x=n[11],T=s*s*c+l,N=o*s*c+u*f,C=u*s*c-o*f,k=s*o*c-u*f,L=o*o*c+l,A=u*o*c+s*f,O=s*u*c+o*f,M=o*u*c-s*f,_=u*u*c+l,e[0]=h*T+m*N+w*C,e[1]=p*T+g*N+E*C,e[2]=d*T+y*N+S*C,e[3]=v*T+b*N+x*C,e[4]=h*k+m*L+w*A,e[5]=p*k+g*L+E*A,e[6]=d*k+y*L+S*A,e[7]=v*k+b*L+x*A,e[8]=h*O+m*M+w*_,e[9]=p*O+g*M+E*_,e[10]=d*O+y*M+S*_,e[11]=v*O+b*M+x*_,n!==e&&(e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e)},c.rotateX=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[4],o=t[5],u=t[6],a=t[7],f=t[8],l=t[9],c=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*i+f*r,e[5]=o*i+l*r,e[6]=u*i+c*r,e[7]=a*i+h*r,e[8]=f*i-s*r,e[9]=l*i-o*r,e[10]=c*i-u*r,e[11]=h*i-a*r,e},c.rotateY=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],u=t[2],a=t[3],f=t[8],l=t[9],c=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i-f*r,e[1]=o*i-l*r,e[2]=u*i-c*r,e[3]=a*i-h*r,e[8]=s*r+f*i,e[9]=o*r+l*i,e[10]=u*r+c*i,e[11]=a*r+h*i,e},c.rotateZ=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),s=t[0],o=t[1],u=t[2],a=t[3],f=t[4],l=t[5],c=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*i+f*r,e[1]=o*i+l*r,e[2]=u*i+c*r,e[3]=a*i+h*r,e[4]=f*i-s*r,e[5]=l*i-o*r,e[6]=c*i-u*r,e[7]=h*i-a*r,e},c.fromRotationTranslation=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=r+r,a=i+i,f=s+s,l=r*u,c=r*a,h=r*f,p=i*a,d=i*f,v=s*f,m=o*u,g=o*a,y=o*f;return e[0]=1-(p+v),e[1]=c+y,e[2]=h-g,e[3]=0,e[4]=c-y,e[5]=1-(l+v),e[6]=d+m,e[7]=0,e[8]=h+g,e[9]=d-m,e[10]=1-(l+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e},c.fromQuat=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n+n,u=r+r,a=i+i,f=n*o,l=n*u,c=n*a,h=r*u,p=r*a,d=i*a,v=s*o,m=s*u,g=s*a;return e[0]=1-(h+d),e[1]=l+g,e[2]=c-m,e[3]=0,e[4]=l-g,e[5]=1-(f+d),e[6]=p+v,e[7]=0,e[8]=c+m,e[9]=p-v,e[10]=1-(f+h),e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},c.frustum=function(e,t,n,r,i,s,o){var u=1/(n-t),a=1/(i-r),f=1/(s-o);return e[0]=s*2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*a,e[6]=0,e[7]=0,e[8]=(n+t)*u,e[9]=(i+r)*a,e[10]=(o+s)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*f,e[15]=0,e},c.perspective=function(e,t,n,r,i){var s=1/Math.tan(t/2),o=1/(r-i);return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+r)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*r*o,e[15]=0,e},c.ortho=function(e,t,n,r,i,s,o){var u=1/(t-n),a=1/(r-i),f=1/(s-o);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+n)*u,e[13]=(i+r)*a,e[14]=(o+s)*f,e[15]=1,e},c.lookAt=function(e,n,r,i){var s,o,u,a,f,l,h,p,d,v,m=n[0],g=n[1],y=n[2],b=i[0],w=i[1],E=i[2],S=r[0],x=r[1],T=r[2];return Math.abs(m-S)<t&&Math.abs(g-x)<t&&Math.abs(y-T)<t?c.identity(e):(h=m-S,p=g-x,d=y-T,v=1/Math.sqrt(h*h+p*p+d*d),h*=v,p*=v,d*=v,s=w*d-E*p,o=E*h-b*d,u=b*p-w*h,v=Math.sqrt(s*s+o*o+u*u),v?(v=1/v,s*=v,o*=v,u*=v):(s=0,o=0,u=0),a=p*u-d*o,f=d*s-h*u,l=h*o-p*s,v=Math.sqrt(a*a+f*f+l*l),v?(v=1/v,a*=v,f*=v,l*=v):(a=0,f=0,l=0),e[0]=s,e[1]=a,e[2]=h,e[3]=0,e[4]=o,e[5]=f,e[6]=p,e[7]=0,e[8]=u,e[9]=l,e[10]=d,e[11]=0,e[12]=-(s*m+o*g+u*y),e[13]=-(a*m+f*g+l*y),e[14]=-(h*m+p*g+d*y),e[15]=1,e)},c.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},typeof e!="undefined"&&(e.mat4=c);var h={};h.create=function(){var e=new n(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},h.rotationTo=function(){var e=o.create(),t=o.fromValues(1,0,0),n=o.fromValues(0,1,0);return function(r,i,s){var u=o.dot(i,s);return u<-0.999999?(o.cross(e,t,i),o.length(e)<1e-6&&o.cross(e,n,i),o.normalize(e,e),h.setAxisAngle(r,e,Math.PI),r):u>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(o.cross(e,i,s),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+u,h.normalize(r,r))}}(),h.setAxes=function(){var e=l.create();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=n[0],e[5]=n[1],e[8]=n[2],h.normalize(t,h.fromMat3(t,e))}}(),h.clone=u.clone,h.fromValues=u.fromValues,h.copy=u.copy,h.set=u.set,h.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},h.setAxisAngle=function(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e},h.add=u.add,h.multiply=function(e,t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=n[0],a=n[1],f=n[2],l=n[3];return e[0]=r*l+o*u+i*f-s*a,e[1]=i*l+o*a+s*u-r*f,e[2]=s*l+o*f+r*a-i*u,e[3]=o*l-r*u-i*a-s*f,e},h.mul=h.multiply,h.scale=u.scale,h.rotateX=function(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],o=t[3],u=Math.sin(n),a=Math.cos(n);return e[0]=r*a+o*u,e[1]=i*a+s*u,e[2]=s*a-i*u,e[3]=o*a-r*u,e},h.rotateY=function(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],o=t[3],u=Math.sin(n),a=Math.cos(n);return e[0]=r*a-s*u,e[1]=i*a+o*u,e[2]=s*a+r*u,e[3]=o*a-i*u,e},h.rotateZ=function(e,t,n){n*=.5;var r=t[0],i=t[1],s=t[2],o=t[3],u=Math.sin(n),a=Math.cos(n);return e[0]=r*a+i*u,e[1]=i*a-r*u,e[2]=s*a+o*u,e[3]=o*a-s*u,e},h.calculateW=function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=-Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},h.dot=u.dot,h.lerp=u.lerp,h.slerp=function(e,t,n,r){var i=t[0],s=t[1],o=t[2],u=t[3],a=n[0],f=n[1],l=n[2],c=n[3],h,p,d,v,m;return p=i*a+s*f+o*l+u*c,p<0&&(p=-p,a=-a,f=-f,l=-l,c=-c),1-p>1e-6?(h=Math.acos(p),d=Math.sin(h),v=Math.sin((1-r)*h)/d,m=Math.sin(r*h)/d):(v=1-r,m=r),e[0]=v*i+m*a,e[1]=v*s+m*f,e[2]=v*o+m*l,e[3]=v*u+m*c,e},h.invert=function(e,t){var n=t[0],r=t[1],i=t[2],s=t[3],o=n*n+r*r+i*i+s*s,u=o?1/o:0;return e[0]=-n*u,e[1]=-r*u,e[2]=-i*u,e[3]=s*u,e},h.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},h.length=u.length,h.len=h.length,h.squaredLength=u.squaredLength,h.sqrLen=h.squaredLength,h.normalize=u.normalize,h.fromMat3=function(){var e=typeof Int8Array!="undefined"?new Int8Array([1,2,0]):[1,2,0];return function(t,n){var r=n[0]+n[4]+n[8],i;if(r>0)i=Math.sqrt(r+1),t[3]=.5*i,i=.5/i,t[0]=(n[7]-n[5])*i,t[1]=(n[2]-n[6])*i,t[2]=(n[3]-n[1])*i;else{var s=0;n[4]>n[0]&&(s=1),n[8]>n[s*3+s]&&(s=2);var o=e[s],u=e[o];i=Math.sqrt(n[s*3+s]-n[o*3+o]-n[u*3+u]+1),t[s]=.5*i,i=.5/i,t[3]=(n[u*3+o]-n[o*3+u])*i,t[o]=(n[o*3+s]+n[s*3+o])*i,t[u]=(n[u*3+s]+n[s*3+u])*i}return t}}(),h.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},typeof e!="undefined"&&(e.quat=h)}(t.exports)})(this);
;
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD;a=self;b=a.Samples=a.Samples||{};c=b.WebGL=b.WebGL||{};d=a.WebSharper=a.WebSharper||{};e=d.Obj=d.Obj||{};f=d.UI=d.UI||{};g=f.HtmlModule=f.HtmlModule||{};h=g.attr=g.attr||{};i=d.Operators=d.Operators||{};j=d.JavaScript=d.JavaScript||{};k=j.JS=j.JS||{};l=f.Doc=f.Doc||{};m=f.AttrProxy=f.AttrProxy||{};n=j.Pervasives=j.Pervasives||{};o=a.EventTarget;p=a.Node;q=a.Element;r=a.HTMLElement;s=d.List=d.List||{};t=d.Unchecked=d.Unchecked||{};u=a.StartupCode$GLMatrix$Client=a.StartupCode$GLMatrix$Client||{};v=a.ArrayBufferView;w=f.Client=f.Client||{};x=w.Templates=w.Templates||{};y=f.DomUtility=f.DomUtility||{};z=f.Attrs=f.Attrs||{};A=s.T=s.T||{};B=d.Arrays=d.Arrays||{};C=d.Seq=d.Seq||{};D=f.AttrModule=f.AttrModule||{};E=f.View=f.View||{};F=d.Collections=d.Collections||{};G=F.Dictionary=F.Dictionary||{};H=f.Elt=f.Elt||{};I=f.Array=f.Array||{};J=d.Enumerator=d.Enumerator||{};K=f.Snap=f.Snap||{};L=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};M=F.HashSet=F.HashSet||{};N=a.WindowOrWorkerGlobalScope;O=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};P=f.Docs=f.Docs||{};Q=f.DocElemNode=f.DocElemNode||{};R=a.CharacterData;S=f.Updates=f.Updates||{};T=a.Object;U=F.DictionaryUtil=F.DictionaryUtil||{};V=x.Prepare=x.Prepare||{};W=d.Slice=d.Slice||{};X=F.KeyCollection=F.KeyCollection||{};Y=f.An=f.An||{};Z=w.Settings=w.Settings||{};_0=f.Abbrev=f.Abbrev||{};_1=_0.Mailbox=_0.Mailbox||{};_2=w.Attrs=w.Attrs||{};_3=_2.Dyn=_2.Dyn||{};_4=_0.Fresh=_0.Fresh||{};_5=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};_6=J.T=J.T||{};_7=d.Strings=d.Strings||{};_8=w.Docs=w.Docs||{};_9=_8.RunState=_8.RunState||{};_=_8.NodeSet=_8.NodeSet||{};$=f.Anims=f.Anims||{};ba=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bb=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bc=d.Concurrency=d.Concurrency||{};bd=f.AppendList=f.AppendList||{};be=F.HashSetUtil=F.HashSetUtil||{};bf=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bg=f.Easing=f.Easing||{};bh=bc.AsyncBody=bc.AsyncBody||{};bi=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bj=bc.CT=bc.CT||{};bk=_0.HashSet=_0.HashSet||{};bl=bc.Scheduler=bc.Scheduler||{};bm=d.CancellationTokenSource=d.CancellationTokenSource||{};bn=_8.DomNodes=_8.DomNodes||{};bo=d.Queue=d.Queue||{};bp=a.Error;bq=d.OperationCanceledException=d.OperationCanceledException||{};br=d.Lazy=d.Lazy||{};bs=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bt=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};bu=bt.LazyRecord=bt.LazyRecord||{};bv=a.Float32Array;bw=a.mat4;bx=a.vec3;by=a.Math;bz=a.IntelliFactory;bA=bz&&bz.Runtime;bB=a.console;bC=a.jQuery;bD=a.Date;c.Main=function(){c.DrawTexturedSquare();};c.DrawTexturedSquare=function(){var bE,bF,bG,bH,bI,bJ,bK,bL;bE=l.Element("canvas",[m.Create("style","z-index:-1; position:absolute;")],[]);bF=c.CreateContext(bE);bF!=null&&bF.$==1?(bG=bF.$0,bH=c.CreateProgram(bG,c.BasicVertexShader(),c.TexturingFragmentShader()),bI=c.CreateSquare(bG,bH),bJ=bI[0],bK=bI[1],c.MakeAndBindTexture(bG,function(){bG.useProgram(bH);bG.uniform1i(bG.getUniformLocation(bH,"tex"),0);c.DrawRotatingObject(bG,bH,bJ,bK);})):a.alert("Couldn't create WebGL context.");bL=l.Element("div",[m.Create("style","position:relative; height: 300;")],[bE,l.Element("p",[],[l.TextNode("This sample shows how you can insert 3D content in a web page.")]),l.Element("p",[],[l.TextNode("Texture data is simply grabbed from an <img> element.")]),l.Element("p",[],[l.TextNode("You can also see that a WebGL context can be placed anywhere, even behind text.")])]);x.LoadLocalTemplates("");l.RunById("main",bL);};c.CreateContext=function(bE){var bF;bF=bE.elt;bF.width=300;bF.height=200;return C.tryPick(function(bG){var bH;bH=bF.getContext(bG);return t.Equals(bH,null)?null:{$:1,$0:bH};},s.ofArray(["webgl","experimental-webgl"]));};c.CreateProgram=function(bE,bF,bG){var bH,bI,bJ;bH=bE.createShader(bE.VERTEX_SHADER);bE.shaderSource(bH,bF);bE.compileShader(bH);!bE.getShaderParameter(bH,bE.COMPILE_STATUS)?(a.alert("Couldn't compile the vertex shader:\n"+bE.getShaderInfoLog(bH)),bE.deleteShader(bH)):void 0;bI=bE.createShader(bE.FRAGMENT_SHADER);bE.shaderSource(bI,bG);bE.compileShader(bI);!bE.getShaderParameter(bI,bE.COMPILE_STATUS)?(a.alert("Couldn't compile the fragment shader:\n"+bE.getShaderInfoLog(bI)),bE.deleteShader(bI)):void 0;bJ=bE.createProgram();bE.attachShader(bJ,bH);bE.attachShader(bJ,bI);bE.linkProgram(bJ);!bE.getProgramParameter(bJ,bE.LINK_STATUS)?(a.alert("Couldn't link the shader program:\n"+bE.getProgramInfoLog(bJ)),bE.deleteProgram(bJ),bE.deleteShader(bI),bE.deleteShader(bI)):void 0;return bJ;};c.BasicVertexShader=function(){u.$cctor();return u.BasicVertexShader;};c.TexturingFragmentShader=function(){u.$cctor();return u.TexturingFragmentShader;};c.CreateSquare=function(bE,bF){var bG,bH,bI,bJ;bG=bE.getAttribLocation(bF,"position");bE.enableVertexAttribArray(bG);bH=bE.getAttribLocation(bF,"texCoord");bE.enableVertexAttribArray(bH);bI=bE.createBuffer();bJ=new a.Float32Array([-1,-1,0,0,0,-1,1,0,0,1,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1,1,-1,0,1,0]);bE.bindBuffer(bE.ARRAY_BUFFER,bI);bE.bufferData(bE.ARRAY_BUFFER,bJ,bE.STATIC_DRAW);bE.vertexAttribPointer(bG,3,bE.FLOAT,false,5*i.toInt(bv.BYTES_PER_ELEMENT),0);bE.vertexAttribPointer(bH,2,bE.FLOAT,false,5*i.toInt(bv.BYTES_PER_ELEMENT),3*i.toInt(bv.BYTES_PER_ELEMENT));return[bI,6];};c.MakeAndBindTexture=function(bE,bF){l.Element("img",[D.Handler("load",function(bG){return function(){var bH;bH=bE.createTexture();bE.activeTexture(bE.TEXTURE0);bE.bindTexture(bE.TEXTURE_2D,bH);bE.pixelStorei(bE.UNPACK_FLIP_Y_WEBGL,1);bE.texImage2D(bE.TEXTURE_2D,0,bE.RGBA,bE.RGBA,bE.UNSIGNED_BYTE,bG);bE.texParameteri(bE.TEXTURE_2D,bE.TEXTURE_MAG_FILTER,bE.LINEAR);bE.texParameteri(bE.TEXTURE_2D,bE.TEXTURE_MIN_FILTER,bE.LINEAR);return bF();};})],[]).elt.setAttribute("src","image.png");};c.DrawRotatingObject=function(bE,bF,bG,bH){var bI;function bJ(bK){var bL,bM;bL=bw.identity(bw.create());bw.translate(bL,bL,bx.fromValues(0,0,-4));bw.rotateY(bL,bL,2*bK*3.14159265358979/1000);bE.uniformMatrix4fv(bI,false,bL);bE.clear(bE.COLOR_BUFFER_BIT|bE.DEPTH_BUFFER_BIT);bE.bindBuffer(bE.ARRAY_BUFFER,bG);bE.drawArrays(bE.TRIANGLES,0,bH);bE.flush();a.setTimeout((bM=(bK+20)%1000,function(bN){return bJ(bM,bN);}),20);}bE.clearColor(0,0,0,0);bE.useProgram(bF);c.SetupView(bE,bF);bI=bE.getUniformLocation(bF,"modelViewMatrix");bJ(0,null);};c.SetupView=function(bE,bF){var bG;bG=bw.perspective(bw.create(),45*by.PI/180,4/3,1,10000);bE.uniformMatrix4fv(bE.getUniformLocation(bF,"perspectiveMatrix"),false,bG);};e=d.Obj=bA.Class({Equals:function(bE){return this===bE;},GetHashCode:function(){return -1;}},null,e);e.New=bA.Ctor(function(){},e);h=g.attr=bA.Class({},e,h);i.toInt=function(bE){var bF;bF=i.toUInt(bE);return bF>=2147483648?bF-4294967296:bF;};i.toUInt=function(bE){return(bE<0?by.ceil(bE):by.floor(bE))>>>0;};i.FailWith=function(bE){throw new bp(bE);};i.KeyValue=function(bE){return[bE.K,bE.V];};k.GetFieldValues=function(bE){var bF,bG;bF=[];for(var bH in bE)bF.push(bE[bH]);return bF;};l=f.Doc=bA.Class({},e,l);l.Element=function(bE,bF,bG){var bH,bI;bH=m.Concat(bF);bI=l.Concat(bG);return H.New(y.CreateElement(bE),bH,bI);};l.TextNode=function(bE){return l.Mk({$:5,$0:y.CreateText(bE)},E.Const());};l.RunById=function(bE,bF){var bG;bG=y.Doc().getElementById(bE);t.Equals(bG,null)?i.FailWith("invalid id: "+bE):l.Run(bG,bF);};l.Concat=function(bE){var bF;bF=I.ofSeqNonCopying(bE);return I.TreeReduce(l.get_Empty(),l.Append,bF);};l.Mk=function(bE,bF){return new l.New(bE,bF);};l.Run=function(bE,bF){P.LinkElement(bE,bF.docNode);l.RunInPlace(false,bE,bF);};l.Append=function(bE,bF){return l.Mk({$:0,$0:bE.docNode,$1:bF.docNode},E.Map2Unit(bE.updates,bF.updates));};l.get_Empty=function(){return l.Mk(null,E.Const());};l.RunInPlace=function(bE,bF,bG){var bH;bH=P.CreateRunState(bF,bG.docNode);E.Sink(Y.get_UseAnimations()||Z.BatchUpdatesEnabled()?_1.StartProcessor(P.PerformAnimatedUpdate(bE,bH,bG.docNode)):function(){P.PerformSyncUpdate(bE,bH,bG.docNode);},bG.updates);};l.New=bA.Ctor(function(bE,bF){e.New.call(this);this.docNode=bE;this.updates=bF;},l);m=f.AttrProxy=bA.Class({},null,m);m.Create=function(bE,bF){return z.Static(function(bG){y.SetAttr(bG,bE,bF);});};m.Concat=function(bE){var bF;bF=I.ofSeqNonCopying(bE);return I.TreeReduce(z.EmptyAttr(),m.Append,bF);};m.Append=function(bE,bF){return z.AppendTree(bE,bF);};n.NewFromSeq=function(bE){var bF,bG,bH;bF={};bG=J.Get(bE);try{while(bG.MoveNext()){bH=bG.Current();bF[bH[0]]=bH[1];}}finally{if(typeof bG=="object"&&"Dispose"in bG)bG.Dispose();}return bF;};s.ofArray=function(bE){var bF,bG,bH;bF=A.Empty;for(bG=B.length(bE)-1,bH=0;bG>=bH;bG--)bF=new A({$:1,$0:B.get(bE,bG),$1:bF});return bF;};s.head=function(bE){return bE.$==1?bE.$0:s.listEmpty();};s.tail=function(bE){return bE.$==1?bE.$1:s.listEmpty();};s.listEmpty=function(){return i.FailWith("The input list was empty.");};t.Equals=function(bE,bF){var bG,bH,bI,bJ;if(bE===bF)return true;else{bG=typeof bE;if(bG=="object"){if(bE===null||bE===void 0||bF===null||bF===void 0)return false;else if("Equals"in bE)return bE.Equals(bF);else if(bE instanceof a.Array&&bF instanceof a.Array)return t.arrayEquals(bE,bF);else if(bE instanceof a.Date&&bF instanceof a.Date)return t.dateEquals(bE,bF);else{bH=[true];for(var bK in bE)if(function(bL){bH[0]=!bE.hasOwnProperty(bL)||bF.hasOwnProperty(bL)&&t.Equals(bE[bL],bF[bL]);return!bH[0];}(bK))break;if(bH[0]){for(var bL in bF)if(function(bM){bH[0]=!bF.hasOwnProperty(bM)||bE.hasOwnProperty(bM);return!bH[0];}(bL))break;}return bH[0];}}else return bG=="function"&&("$Func"in bE?bE.$Func===bF.$Func&&bE.$Target===bF.$Target:"$Invokes"in bE&&"$Invokes"in bF&&t.arrayEquals(bE.$Invokes,bF.$Invokes));}};t.arrayEquals=function(bE,bF){var bG,bH;if(B.length(bE)===B.length(bF)){bG=true;bH=0;while(bG&&bH<B.length(bE)){!t.Equals(B.get(bE,bH),B.get(bF,bH))?bG=false:void 0;bH=bH+1;}return bG;}else return false;};t.dateEquals=function(bE,bF){return bE.getTime()===bF.getTime();};t.Hash=function(bE){var bF;bF=typeof bE;return bF=="function"?0:bF=="boolean"?bE?1:0:bF=="number"?bE:bF=="string"?t.hashString(bE):bF=="object"?bE==null?0:bE instanceof a.Array?t.hashArray(bE):t.hashObject(bE):0;};t.hashString=function(bE){var bF,bG,bH;if(bE===null)return 0;else{bF=5381;for(bG=0,bH=bE.length-1;bG<=bH;bG++)bF=t.hashMix(bF,bE[bG].charCodeAt());return bF;}};t.hashArray=function(bE){var bF,bG,bH;bF=-34948909;for(bG=0,bH=B.length(bE)-1;bG<=bH;bG++)bF=t.hashMix(bF,t.Hash(B.get(bE,bG)));return bF;};t.hashObject=function(bE){var bF,bG;if("GetHashCode"in bE)return bE.GetHashCode();else{bF=[0];for(var bH in bE)if(function(bI){bF[0]=t.hashMix(t.hashMix(bF[0],t.hashString(bI)),t.Hash(bE[bI]));return false;}(bH))break;return bF[0];}};t.hashMix=function(bE,bF){return(bE<<5)+bE+bF;};t.Compare=function(bE,bF){var bG,bH,bI,bJ,bK,bL;if(bE===bF)return 0;else{bH=typeof bE;switch(bH=="function"?1:bH=="boolean"?2:bH=="number"?2:bH=="string"?2:bH=="object"?3:0){case 0:return typeof bF=="undefined"?0:-1;case 1:return i.FailWith("Cannot compare function values.");case 2:return bE<bF?-1:1;case 3:if(bE===null)bI=-1;else if(bF===null)bI=1;else if("CompareTo"in bE)bI=bE.CompareTo(bF);else if("CompareTo0"in bE)bI=bE.CompareTo0(bF);else if(bE instanceof a.Array&&bF instanceof a.Array)bI=t.compareArrays(bE,bF);else if(bE instanceof a.Date&&bF instanceof a.Date)bI=t.compareDates(bE,bF);else{bJ=[0];for(var bM in bE)if(function(bN){return!bE.hasOwnProperty(bN)?false:!bF.hasOwnProperty(bN)?(bJ[0]=1,true):(bJ[0]=t.Compare(bE[bN],bF[bN]),bJ[0]!==0);}(bM))break;if(bJ[0]===0){for(var bN in bF)if(function(bO){return!bF.hasOwnProperty(bO)?false:!bE.hasOwnProperty(bO)&&(bJ[0]=-1,true);}(bN))break;}bI=bJ[0];}return bI;}}};t.compareArrays=function(bE,bF){var bG,bH;if(B.length(bE)<B.length(bF))return -1;else if(B.length(bE)>B.length(bF))return 1;else{bG=0;bH=0;while(bG===0&&bH<B.length(bE)){bG=t.Compare(B.get(bE,bH),B.get(bF,bH));bH=bH+1;}return bG;}};t.compareDates=function(bE,bF){return t.Compare(bE.getTime(),bF.getTime());};u.$cctor=function(){u.$cctor=a.ignore;u.BasicVertexShader="\n        precision highp float;\n        attribute vec3 position;\n        attribute vec2 texCoord;\n        uniform mat4 perspectiveMatrix;\n        uniform mat4  modelViewMatrix;\n        varying vec2 textureCoord;\n        void main(void)\n        {\n            gl_Position = perspectiveMatrix * modelViewMatrix * vec4(position, 1.0);\n            textureCoord = texCoord;\n        }";u.TexturingFragmentShader="\n        precision highp float;\n        uniform sampler2D tex;\n        varying vec2 textureCoord;\n        void main(void)\n        {\n            gl_FragColor = texture2D(tex, textureCoord);\n        }";};x.LoadLocalTemplates=function(bE){!x.LocalTemplatesLoaded()?(x.set_LocalTemplatesLoaded(true),x.LoadNestedTemplates(self.document.body,"")):void 0;x.LoadedTemplates().set_Item(bE,x.LoadedTemplateFile(""));};x.LocalTemplatesLoaded=function(){L.$cctor();return L.LocalTemplatesLoaded;};x.set_LocalTemplatesLoaded=function(bE){L.$cctor();L.LocalTemplatesLoaded=bE;};x.LoadNestedTemplates=function(bE,bF){var bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU;function bG(bV){var bW,bX;if(!bH.ContainsKey(bV)){bW=(bX=null,[bI.TryGetValue(bV,{get:function(){return bX;},set:function(bY){bX=bY;}}),bX]);bW[0]?(bU.Add(bV),bI.Remove(bV),x.PrepareTemplateStrict(bF,{$:1,$0:bV},bW[1][0],{$:1,$0:bW[1][1]},{$:1,$0:bG})):bB.warn(bU.Contains(bV)?"Encountered loop when instantiating "+bV:"Local template does not exist: "+bV);}}bH=x.LoadedTemplateFile(bF);bI=new G.New$5();bJ=bE.querySelectorAll("[ws-template]");for(bK=0,bL=bJ.length-1;bK<=bL;bK++){bM=bJ[bK];bN=bM.getAttribute("ws-template").toLowerCase();bM.removeAttribute("ws-template");bI.set_Item(bN,[[bM],x.FakeRootSingle(bM)]);}bO=bE.querySelectorAll("[ws-children-template]");for(bP=0,bQ=bO.length-1;bP<=bQ;bP++){bR=bO[bP];bS=bR.getAttribute("ws-children-template").toLowerCase();bR.removeAttribute("ws-children-template");bI.set_Item(bS,(bT=y.ChildrenArray(bR),[bT,x.FakeRoot(bT)]));}bU=new M.New$3();while(bI.count>0)bG(C.head(bI.get_Keys()));};x.LoadedTemplates=function(){L.$cctor();return L.LoadedTemplates;};x.LoadedTemplateFile=function(bE){var bF,bG,bH;bF=(bG=null,[x.LoadedTemplates().TryGetValue(bE,{get:function(){return bG;},set:function(bI){bG=bI;}}),bG]);return bF[0]?bF[1]:(bH=new G.New$5(),(x.LoadedTemplates().set_Item(bE,bH),bH));};x.FakeRootSingle=function(bE){var bF,bG,bH;bE.removeAttribute("ws-template");bF=bE.getAttribute("ws-replace");bF===null?void 0:(bE.removeAttribute("ws-replace"),bG=bE.parentNode,t.Equals(bG,null)?void 0:(bH=self.document.createElement(bE.tagName),bH.setAttribute("ws-replace",bF),bG.replaceChild(bH,bE)));return x.FakeRoot([bE]);};x.FakeRoot=function(bE){var bF,bG,bH;bF=self.document.createElement("div");for(bG=0,bH=bE.length-1;bG<=bH;bG++)bF.appendChild(B.get(bE,bG));return bF;};x.PrepareTemplateStrict=function(bE,bF,bG,bH,bI){var bJ,bK;function bL(bQ,bR){var bS,bT,bU,bV,bW,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_,b$,ca,cb,cc,cd,ce,cf,cg;function bX(ch){}while(true)switch(bQ){case 0:if(bR!==null){bS=bR.nextSibling;if(t.Equals(bR.nodeType,p.TEXT_NODE))V.convertTextNode(bR);else if(t.Equals(bR.nodeType,p.ELEMENT_NODE))bN(bR);bR=bS;}else return null;break;case 1:bY=W.string(bR.nodeName,{$:1,$0:3},null).toLowerCase();bZ=(bT=bY.indexOf("."),bT===-1?[bE,bY]:[W.string(bY,null,{$:1,$0:bT-1}),W.string(bY,{$:1,$0:bT+1},null)]);b0=bZ[1];b1=bZ[0];if(b1!==""&&!x.LoadedTemplates().ContainsKey(b1))return V.failNotLoaded(b0);else{if(b1===""&&bI!=null)bI.$0(b0);b2=x.LoadedTemplates().get_Item(b1);if(!b2.ContainsKey(b0))return V.failNotLoaded(b0);else{b3=b2.get_Item(b0);b4=b3.cloneNode(true);b5=new M.New$3();b6=new G.New$5();b7=bR.attributes;for(b8=0,b9=b7.length-1;b8<=b9;b8++){b_=b7.item(b8).name.toLowerCase();b6.set_Item(b_,(b$=b7.item(b8).nodeValue,b$===""?b_:b$.toLowerCase()));!b5.Add(b_)?bB.warn("Hole mapped twice",b_):void 0;}for(ca=0,cb=bR.childNodes.length-1;ca<=cb;ca++){cc=bR.childNodes[ca];t.Equals(cc.nodeType,p.ELEMENT_NODE)?!b5.Add(cc.nodeName.toLowerCase())?bB.warn("Hole filled twice",b0):void 0:void 0;}cd=bR.childNodes.length===1&&t.Equals(bR.firstChild.nodeType,p.TEXT_NODE);if(cd){bV=V.fillTextHole(b4,bR.firstChild.textContent,b0);((function(ch){return function(ci){if(ci!=null)ch(ci.$0);};}((bW=function(ch){return function(ci){return ch.Add(ci);};}(b5),function(ch){return bX(bW(ch));})))(bV));}V.removeHolesExcept(b4,b5);if(!cd){for(ce=0,cf=bR.childNodes.length-1;ce<=cf;ce++){cg=bR.childNodes[ce];t.Equals(cg.nodeType,p.ELEMENT_NODE)?cg.hasAttributes()?V.fillInstanceAttrs(b4,cg):bM(b4,cg):void 0;}}V.mapHoles(b4,b6);V.fill(b4,bR.parentNode,bR);bR.parentNode.removeChild(bR);return;}}break;}}function bM(bQ,bR){var bS,bU,bV;function bT(bW,bX){var bY,bZ,b0;if(bU==="title"&&bR.hasChildNodes()){bY=bC.parseHTML(bR.textContent);bR.removeChild(bR.firstChild);for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++)bR.appendChild(B.get(bY,bZ));}else null;bN(bR);return V.fill(bR,bW,bX);}bU=bR.nodeName.toLowerCase();y.IterSelector(bQ,"[ws-attr-holes]",function(bW){var bX,bY,bZ,b0,b1;bX=_7.SplitChars(bW.getAttribute("ws-attr-holes"),[" "],1);for(bY=0,bZ=bX.length-1;bY<=bZ;bY++){b0=B.get(bX,bY);bW.setAttribute(b0,(b1=new a.RegExp("\\${"+bU+"}","ig"),bW.getAttribute(b0).replace(b1,bR.textContent)));}});bV=bQ.querySelector("[ws-hole="+bU+"]");if(t.Equals(bV,null)){bS=bQ.querySelector("[ws-replace="+bU+"]");return t.Equals(bS,null)?null:(bT(bS.parentNode,bS),void bS.parentNode.removeChild(bS));}else{while(bV.hasChildNodes())bV.removeChild(bV.lastChild);bV.removeAttribute("ws-hole");return bT(bV,null);}}function bN(bQ){if(_7.StartsWith(bQ.nodeName.toLowerCase(),"ws-"))bP(bQ);else{V.convertAttrs(bQ);bO(bQ.firstChild);}}function bO(bQ){return bL(0,bQ);}function bP(bQ){return bL(1,bQ);}bJ=bH==null?x.FakeRoot(bG):bH.$0;bK=(bF==null?"":bF.$0).toLowerCase();x.LoadedTemplateFile(bE).set_Item(bK,bJ);B.length(bG)>0?(function(bQ){var bR,bS,bT,bU;while(true){bR=bQ.querySelector("[ws-template]");if(t.Equals(bR,null)){bS=bQ.querySelector("[ws-children-template]");if(t.Equals(bS,null))return null;else{bT=bS.getAttribute("ws-children-template");bS.removeAttribute("ws-children-template");x.PrepareTemplateStrict(bE,{$:1,$0:bT},y.ChildrenArray(bS),null,null);bQ=bQ;}}else{bU=bR.getAttribute("ws-template");(x.PrepareSingleTemplate(bE,{$:1,$0:bU},bR))(null);bQ=bQ;}}}(bJ),bO(B.get(bG,0))):void 0;};x.PrepareSingleTemplate=function(bE,bF,bG){var bH,bI,bJ;bH=x.FakeRootSingle(bG);bI=[bG];bJ={$:1,$0:bH};return function(bK){x.PrepareTemplateStrict(bE,bF,bI,bJ,bK);};};x.TextHoleRE=function(){L.$cctor();return L.TextHoleRE;};y.CreateElement=function(bE){return y.Doc().createElement(bE);};y.SetAttr=function(bE,bF,bG){bE.setAttribute(bF,bG);};y.CreateText=function(bE){return y.Doc().createTextNode(bE);};y.Doc=function(){O.$cctor();return O.Doc;};y.ChildrenArray=function(bE){var bF,bG,bH;bF=[];for(bG=0,bH=bE.childNodes.length-1;bG<=bH;bG++)bF.push(bE.childNodes[bG]);return bF;};y.IterSelector=function(bE,bF,bG){var bH,bI,bJ;bH=bE.querySelectorAll(bF);for(bI=0,bJ=bH.length-1;bI<=bJ;bI++)bG(bH[bI]);};y.InsertAt=function(bE,bF,bG){var bH;if(!(bG.parentNode===bE&&bF===(bH=bG.nextSibling,t.Equals(bH,null)?null:bH)))bE.insertBefore(bG,bF);};y.RemoveNode=function(bE,bF){if(bF.parentNode===bE)bE.removeChild(bF);};z.Static=function(bE){return new m({$:3,$0:bE});};z.Updates=function(bE){return I.MapTreeReduce(function(bF){return bF.NChanged();},E.Const(),E.Map2Unit,bE.DynNodes);};z.AppendTree=function(bE,bF){var bG;return bE===null?bF:bF===null?bE:(bG=new m({$:2,$0:bE,$1:bF}),(z.SetFlags(bG,z.Flags(bE)|z.Flags(bF)),bG));};z.EmptyAttr=function(){_5.$cctor();return _5.EmptyAttr;};z.Insert=function(bE,bF){var bG,bH,bI;function bJ(bK){if(!(bK===null))if(bK!=null&&bK.$==1)bG.push(bK.$0);else if(bK!=null&&bK.$==2){bJ(bK.$0);bJ(bK.$1);}else if(bK!=null&&bK.$==3)bK.$0(bE);else if(bK!=null&&bK.$==4)bH.push(bK.$0);}bG=[];bH=[];bJ(bF);bI=bG.slice(0);return _3.New(bE,z.Flags(bF),bI,bH.length===0?null:{$:1,$0:function(bK){C.iter(function(bL){bL(bK);},bH);}});};z.SetFlags=function(bE,bF){bE.flags=bF;};z.Flags=function(bE){return bE!==null&&bE.hasOwnProperty("flags")?bE.flags:0;};z.HasExitAnim=function(bE){var bF;bF=2;return(bE.DynFlags&bF)===bF;};z.GetExitAnim=function(bE){return z.GetAnim(bE,function(bF,bG){return bF.NGetExitAnim(bG);});};z.HasEnterAnim=function(bE){var bF;bF=1;return(bE.DynFlags&bF)===bF;};z.GetEnterAnim=function(bE){return z.GetAnim(bE,function(bF,bG){return bF.NGetEnterAnim(bG);});};z.HasChangeAnim=function(bE){var bF;bF=4;return(bE.DynFlags&bF)===bF;};z.GetChangeAnim=function(bE){return z.GetAnim(bE,function(bF,bG){return bF.NGetChangeAnim(bG);});};z.GetAnim=function(bE,bF){return Y.Concat(B.map(function(bG){return bF(bG,bE.DynElem);},bE.DynNodes));};z.Sync=function(bE,bF){B.iter(function(bG){bG.NSync(bE);},bF.DynNodes);};A=s.T=bA.Class({GetEnumerator:function(){return new _6.New(this,null,function(bE){var bF;bF=bE.s;return bF.$==0?false:(bE.c=bF.$0,bE.s=bF.$1,true);},void 0);},GetEnumerator0:function(){return J.Get(this);}},null,A);A.Empty=new A({$:0});B.get=function(bE,bF){B.checkBounds(bE,bF);return bE[bF];};B.length=function(bE){return bE.dims===2?bE.length*bE.length:bE.length;};B.checkBounds=function(bE,bF){if(bF<0||bF>=bE.length)i.FailWith("Index was outside the bounds of the array.");};B.set=function(bE,bF,bG){B.checkBounds(bE,bF);bE[bF]=bG;};C.tryPick=function(bE,bF){var bG,bH;bG=J.Get(bF);try{bH=null;while(t.Equals(bH,null)&&bG.MoveNext())bH=bE(bG.Current());return bH;}finally{if(typeof bG=="object"&&"Dispose"in bG)bG.Dispose();}};C.head=function(bE){var bF;bF=J.Get(bE);try{return bF.MoveNext()?bF.Current():C.insufficient();}finally{if(typeof bF=="object"&&"Dispose"in bF)bF.Dispose();}};C.fold=function(bE,bF,bG){var bH,bI;bH=bF;bI=J.Get(bG);try{while(bI.MoveNext())bH=bE(bH,bI.Current());return bH;}finally{if(typeof bI=="object"&&"Dispose"in bI)bI.Dispose();}};C.iter=function(bE,bF){var bG;bG=J.Get(bF);try{while(bG.MoveNext())bE(bG.Current());}finally{if(typeof bG=="object"&&"Dispose"in bG)bG.Dispose();}};C.map=function(bE,bF){return{GetEnumerator:function(){var bG;bG=J.Get(bF);return new _6.New(null,null,function(bH){return bG.MoveNext()&&(bH.c=bE(bG.Current()),true);},function(){bG.Dispose();});}};};C.max=function(bE){var bF,bG,bH;bF=J.Get(bE);try{if(!bF.MoveNext())C.seqEmpty();bG=bF.Current();while(bF.MoveNext()){bH=bF.Current();t.Compare(bH,bG)===1?bG=bH:void 0;}return bG;}finally{if(typeof bF=="object"&&"Dispose"in bF)bF.Dispose();}};C.seqEmpty=function(){return i.FailWith("The input sequence was empty.");};D.Handler=function(bE,bF){return z.Static(function(bG){bG.addEventListener(bE,function(bH){return(bF(bG))(bH);},false);});};E.Const=function(bE){var bF;bF=K.New({$:0,$0:bE});return function(){return bF;};};E.Map2Unit=function(bE,bF){return E.CreateLazy(function(){return K.Map2Unit(bE(),bF());});};E.Sink=function(bE,bF){function bG(){K.WhenRun(bF(),bE,function(){bc.scheduler().Fork(bG);});}bc.scheduler().Fork(bG);};E.CreateLazy=function(bE){var bF;bF={c:null,o:bE};return function(){var bG,bH;bG=bF.c;return bG===null?(bG=bF.o(),bF.c=bG,(bH=bG.s,bH!=null&&bH.$==0)?bF.o=null:K.WhenObsoleteRun(bG,function(){bF.c=null;}),bG):bG;};};G=F.Dictionary=bA.Class({set_Item:function(bE,bF){this.set(bE,bF);},ContainsKey:function(bE){var bF,bG;bF=this;bG=this.data[this.hash(bE)];return bG==null?false:B.exists(function(bH){return bF.equals.apply(null,[(i.KeyValue(bH))[0],bE]);},bG);},TryGetValue:function(bE,bF){var bG,bH,bI;bG=this;bH=this.data[this.hash(bE)];return bH==null?false:(bI=B.tryPick(function(bJ){var bK;bK=i.KeyValue(bJ);return bG.equals.apply(null,[bK[0],bE])?{$:1,$0:bK[1]}:null;},bH),bI!=null&&bI.$==1&&(bF.set(bI.$0),true));},Remove:function(bE){return this.remove(bE);},get_Keys:function(){return new X.New(this);},set:function(bE,bF){var bG,bH,bI,bJ;bG=this;bH=this.hash(bE);bI=this.data[bH];bI==null?(this.count=this.count+1,this.data[bH]=new a.Array({K:bE,V:bF})):(bJ=B.tryFindIndex(function(bK){return bG.equals.apply(null,[(i.KeyValue(bK))[0],bE]);},bI),bJ==null?(this.count=this.count+1,bI.push({K:bE,V:bF})):bI[bJ.$0]={K:bE,V:bF});},remove:function(bE){var bF,bG,bH,bI;bF=this;bG=this.hash(bE);bH=this.data[bG];return bH==null?false:(bI=B.filter(function(bJ){return!bF.equals.apply(null,[(i.KeyValue(bJ))[0],bE]);},bH),B.length(bI)<bH.length&&(this.count=this.count-1,this.data[bG]=bI,true));},get_Item:function(bE){return this.get(bE);},get:function(bE){var bF,bG;bF=this;bG=this.data[this.hash(bE)];return bG==null?U.notPresent():B.pick(function(bH){var bI;bI=i.KeyValue(bH);return bF.equals.apply(null,[bI[0],bE])?{$:1,$0:bI[1]}:null;},bG);},GetEnumerator:function(){return J.Get0(this);},GetEnumerator0:function(){return J.Get0(B.concat(k.GetFieldValues(this.data)));}},e,G);G.New$5=bA.Ctor(function(){G.New$6.call(this,[],t.Equals,t.Hash);},G);G.New$6=bA.Ctor(function(bE,bF,bG){var bH,bI;e.New.call(this);this.equals=bF;this.hash=bG;this.count=0;this.data=[];bH=J.Get(bE);try{while(bH.MoveNext()){bI=bH.Current();this.set(bI.K,bI.V);}}finally{if(typeof bH=="object"&&"Dispose"in bH)bH.Dispose();}},G);E=f.View=bA.Class({},null,E);H=f.Elt=bA.Class({},l,H);H.New=function(bE,bF,bG){var bH,bI;bH=P.CreateElemNode(bE,bF,bG.docNode);bI=S.Create(bG.updates);return new H.New$1({$:1,$0:bH},E.Map2Unit(z.Updates(bH.Attr),bI.v),bE,bI);};H.New$1=bA.Ctor(function(bE,bF,bG,bH){l.New.call(this,bE,bF);this.docNode$1=bE;this.updates$1=bF;this.elt=bG;this.rvUpdates=bH;},H);I.ofSeqNonCopying=function(bE){var bF,bG;if(bE instanceof a.Array)return bE;else if(bE instanceof A)return B.ofList(bE);else if(bE===null)return[];else{bF=[];bG=J.Get(bE);try{while(bG.MoveNext())bF.push(bG.Current());return bF;}finally{if(typeof bG=="object"&&"Dispose"in bG)bG.Dispose();}}};I.TreeReduce=function(bE,bF,bG){var bH;function bI(bJ,bK){var bL,bM;return bK<=0?bE:bK===1&&(bJ>=0&&bJ<bH)?B.get(bG,bJ):(bM=bK/2>>0,bF(bI(bJ,bM),bI(bJ+bM,bK-bM)));}bH=B.length(bG);return bI(0,bH);};I.MapTreeReduce=function(bE,bF,bG,bH){var bI;function bJ(bK,bL){var bM,bN;return bL<=0?bF:bL===1&&(bK>=0&&bK<bI)?bE(B.get(bH,bK)):(bN=bL/2>>0,bG(bJ(bK,bN),bJ(bK+bN,bL-bN)));}bI=B.length(bH);return bJ(0,bI);};J.Get=function(bE){return bE instanceof a.Array?J.ArrayEnumerator(bE):t.Equals(typeof bE,"string")?J.StringEnumerator(bE):bE.GetEnumerator();};J.ArrayEnumerator=function(bE){return new _6.New(0,null,function(bF){var bG;bG=bF.s;return bG<B.length(bE)&&(bF.c=B.get(bE,bG),bF.s=bG+1,true);},void 0);};J.StringEnumerator=function(bE){return new _6.New(0,null,function(bF){var bG;bG=bF.s;return bG<bE.length&&(bF.c=bE[bG],bF.s=bG+1,true);},void 0);};J.Get0=function(bE){return bE instanceof a.Array?J.ArrayEnumerator(bE):t.Equals(typeof bE,"string")?J.StringEnumerator(bE):"GetEnumerator0"in bE?bE.GetEnumerator0():bE.GetEnumerator();};K.Copy=function(bE){var bF,bG,bH;bF=bE.s;return bF==null?bE:bF!=null&&bF.$==2?(bG=K.New({$:2,$0:bF.$0,$1:[]}),(K.WhenObsolete(bE,bG),bG)):bF!=null&&bF.$==3?(bH=K.New({$:3,$0:[],$1:[]}),(K.When(bE,function(bI){K.MarkDone(bH,bE,bI);},bH),bH)):bE;};K.WhenObsoleteRun=function(bE,bF){var bG;bG=bE.s;bG==null?bF():bG!=null&&bG.$==2?bG.$1.push(bF):bG!=null&&bG.$==3?bG.$1.push(bF):void 0;};K.Map2Unit=function(bE,bF){var bG,bH,bI;function bJ(){var bK,bL,bM;if(!(bK=bI.s,bK!=null&&bK.$==0||bK!=null&&bK.$==2)){bL=K.ValueAndForever(bE);bM=K.ValueAndForever(bF);bL!=null&&bL.$==1?bM!=null&&bM.$==1?bL.$0[1]&&bM.$0[1]?K.MarkForever(bI,null):K.MarkReady(bI,null):void 0:void 0;}}bG=bE.s;bH=bF.s;return bG!=null&&bG.$==0?bH!=null&&bH.$==0?K.New({$:0,$0:null}):bF:bH!=null&&bH.$==0?bE:(bI=K.New({$:3,$0:[],$1:[]}),(K.When(bE,bJ,bI),K.When(bF,bJ,bI),bI));};K.WhenRun=function(bE,bF,bG){var bH;bH=bE.s;bH==null?bG():bH!=null&&bH.$==2?(bH.$1.push(bG),bF(bH.$0)):bH!=null&&bH.$==3?(bH.$0.push(bF),bH.$1.push(bG)):bF(bH.$0);};K.WhenObsolete=function(bE,bF){var bG;bG=bE.s;bG==null?K.Obsolete(bF):bG!=null&&bG.$==2?K.EnqueueSafe(bG.$1,bF):bG!=null&&bG.$==3?K.EnqueueSafe(bG.$1,bF):void 0;};K.When=function(bE,bF,bG){var bH;bH=bE.s;bH==null?K.Obsolete(bG):bH!=null&&bH.$==2?(K.EnqueueSafe(bH.$1,bG),bF(bH.$0)):bH!=null&&bH.$==3?(bH.$0.push(bF),K.EnqueueSafe(bH.$1,bG)):bF(bH.$0);};K.MarkDone=function(bE,bF,bG){var bH;if(bH=bF.s,bH!=null&&bH.$==0)K.MarkForever(bE,bG);else K.MarkReady(bE,bG);};K.ValueAndForever=function(bE){var bF;bF=bE.s;return bF!=null&&bF.$==0?{$:1,$0:[bF.$0,true]}:bF!=null&&bF.$==2?{$:1,$0:[bF.$0,false]}:null;};K.MarkForever=function(bE,bF){var bG,bH,bI,bJ;bG=bE.s;if(bG!=null&&bG.$==3){bE.s={$:0,$0:bF};bH=bG.$0;for(bI=0,bJ=B.length(bH)-1;bI<=bJ;bI++)(B.get(bH,bI))(bF);}else void 0;};K.MarkReady=function(bE,bF){var bG,bH,bI,bJ;bG=bE.s;if(bG!=null&&bG.$==3){bE.s={$:2,$0:bF,$1:bG.$1};bH=bG.$0;for(bI=0,bJ=B.length(bH)-1;bI<=bJ;bI++)(B.get(bH,bI))(bF);}else void 0;};K.EnqueueSafe=function(bE,bF){var bG,bH,bI,bJ;bE.push(bF);if(bE.length%20===0){bG=bE.slice(0);bo.Clear(bE);for(bH=0,bI=B.length(bG)-1;bH<=bI;bH++){bJ=B.get(bG,bH);typeof bJ=="object"?function(bK){if(bK.s)bE.push(bK);}(bJ):function(bK){bE.push(bK);}(bJ);}}else void 0;};L.$cctor=function(){L.$cctor=a.ignore;L.LoadedTemplates=new G.New$5();L.LocalTemplatesLoaded=false;L.TextHoleRE="\\${([^}]+)}";};M=F.HashSet=bA.Class({Add:function(bE){return this.add(bE);},Contains:function(bE){var bF;bF=this.data[this.hash(bE)];return bF==null?false:this.arrContains(bE,bF);},add:function(bE){var bF,bG;bF=this.hash(bE);bG=this.data[bF];return bG==null?(this.data[bF]=[bE],this.count=this.count+1,true):this.arrContains(bE,bG)?false:(bG.push(bE),this.count=this.count+1,true);},arrContains:function(bE,bF){var bG,bH,bI,bJ;bG=true;bH=0;bJ=bF.length;while(bG&&bH<bJ)if(this.equals.apply(null,[bF[bH],bE]))bG=false;else bH=bH+1;return!bG;},ExceptWith:function(bE){var bF;bF=J.Get(bE);try{while(bF.MoveNext())this.Remove(bF.Current());}finally{if(typeof bF=="object"&&"Dispose"in bF)bF.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(bE){var bF,bG,bH,bI;bF=0;bG=be.concat(this.data);for(bH=0,bI=bG.length-1;bH<=bI;bH++)B.set(bE,bH,bG[bH]);},IntersectWith:function(bE){var bF,bG,bH,bI,bJ;bF=new M.New$4(bE,this.equals,this.hash);bG=be.concat(this.data);for(bH=0,bI=bG.length-1;bH<=bI;bH++){bJ=bG[bH];!bF.Contains(bJ)?this.Remove(bJ):void 0;}},Remove:function(bE){var bF;bF=this.data[this.hash(bE)];return bF==null?false:this.arrRemove(bE,bF)&&(this.count=this.count-1,true);},arrRemove:function(bE,bF){var bG,bH,bI,bJ;bG=true;bH=0;bJ=bF.length;while(bG&&bH<bJ)if(this.equals.apply(null,[bF[bH],bE])){bF.splice.apply(bF,[bH,1]);bG=false;}else bH=bH+1;return!bG;},GetEnumerator:function(){return J.Get(be.concat(this.data));},GetEnumerator0:function(){return J.Get(be.concat(this.data));}},e,M);M.New$3=bA.Ctor(function(){M.New$4.call(this,[],t.Equals,t.Hash);},M);M.New$4=bA.Ctor(function(bE,bF,bG){var bH;e.New.call(this);this.equals=bF;this.hash=bG;this.data=[];this.count=0;bH=J.Get(bE);try{while(bH.MoveNext())this.add(bH.Current());}finally{if(typeof bH=="object"&&"Dispose"in bH)bH.Dispose();}},M);M.New$2=bA.Ctor(function(bE){M.New$4.call(this,bE,t.Equals,t.Hash);},M);O.$cctor=function(){O.$cctor=a.ignore;O.Doc=self.document;};P.LinkElement=function(bE,bF){P.InsertDoc(bE,bF,null);};P.CreateElemNode=function(bE,bF,bG){var bH;P.LinkElement(bE,bG);bH=z.Insert(bE,bF);return Q.New(bH,bG,null,bE,_4.Int(),bA.GetOptional(bH.OnAfterRender));};P.InsertDoc=function(bE,bF,bG){var bH;return bF!=null&&bF.$==1?P.InsertNode(bE,bF.$0.El,bG):bF!=null&&bF.$==2?(bH=bF.$0,(bH.Dirty=false,P.InsertDoc(bE,bH.Current,bG))):bF==null?bG:bF!=null&&bF.$==4?P.InsertNode(bE,bF.$0.Text,bG):bF!=null&&bF.$==5?P.InsertNode(bE,bF.$0,bG):bF!=null&&bF.$==6?B.foldBack(function(bI,bJ){return bI==null||bI.constructor===T?P.InsertDoc(bE,bI,bJ):P.InsertNode(bE,bI,bJ);},bF.$0.Els,bG):P.InsertDoc(bE,bF.$0,P.InsertDoc(bE,bF.$1,bG));};P.CreateRunState=function(bE,bF){return _9.New(_.get_Empty(),P.CreateElemNode(bE,z.EmptyAttr(),bF));};P.PerformAnimatedUpdate=function(bE,bF,bG){var bH;return Y.get_UseAnimations()?(bH=null,bc.Delay(function(){var bI,bJ,bK;bI=_.FindAll(bG);bJ=P.ComputeChangeAnim(bF,bI);bK=P.ComputeEnterAnim(bF,bI);return bc.Bind(Y.Play(Y.Append(bJ,P.ComputeExitAnim(bF,bI))),function(){return bc.Bind(P.SyncElemNodesNextFrame(bE,bF),function(){return bc.Bind(Y.Play(bK),function(){bF.PreviousNodes=bI;return bc.Return(null);});});});})):P.SyncElemNodesNextFrame(bE,bF);};P.PerformSyncUpdate=function(bE,bF,bG){var bH;bH=_.FindAll(bG);P.SyncElemNode(bE,bF.Top);bF.PreviousNodes=bH;};P.InsertNode=function(bE,bF,bG){y.InsertAt(bE,bG,bF);return bF;};P.SyncElemNodesNextFrame=function(bE,bF){function bG(bH){a.requestAnimationFrame(function(){P.SyncElemNode(bE,bF.Top);bH();});}return Z.BatchUpdatesEnabled()?bc.FromContinuations(function(bH,bI,bJ){return bG.apply(null,[bH,bI,bJ]);}):(P.SyncElemNode(bE,bF.Top),bc.Return(null));};P.ComputeExitAnim=function(bE,bF){return Y.Concat(B.map(function(bG){return z.GetExitAnim(bG.Attr);},_.ToArray(_.Except(bF,_.Filter(function(bG){return z.HasExitAnim(bG.Attr);},bE.PreviousNodes)))));};P.ComputeEnterAnim=function(bE,bF){return Y.Concat(B.map(function(bG){return z.GetEnterAnim(bG.Attr);},_.ToArray(_.Except(bE.PreviousNodes,_.Filter(function(bG){return z.HasEnterAnim(bG.Attr);},bF)))));};P.ComputeChangeAnim=function(bE,bF){var bG;function bH(bI){return z.HasChangeAnim(bI.Attr);}bG=function(bI){return _.Filter(bH,bI);};return Y.Concat(B.map(function(bI){return z.GetChangeAnim(bI.Attr);},_.ToArray(_.Intersect(bG(bE.PreviousNodes),bG(bF)))));};P.SyncElemNode=function(bE,bF){!bE?P.SyncElement(bF):void 0;P.Sync(bF.Children);P.AfterRender(bF);};P.SyncElement=function(bE){function bF(bG){function bH(bI){var bJ,bK;return bI!=null&&bI.$==0?bH(bI.$0)||bH(bI.$1):bI!=null&&bI.$==2?(bJ=bI.$0,bJ.Dirty||bH(bJ.Current)):bI!=null&&bI.$==6&&(bK=bI.$0,bK.Dirty||B.exists(bF,bK.Holes));}return bH(bG.Children);}z.Sync(bE.El,bE.Attr);bF(bE)?P.DoSyncElement(bE):void 0;};P.Sync=function(bE){var bF,bG;if(bE!=null&&bE.$==1)P.SyncElemNode(false,bE.$0);else if(bE!=null&&bE.$==2)P.Sync(bE.$0.Current);else if(bE==null);else if(bE!=null&&bE.$==5);else if(bE!=null&&bE.$==4){bF=bE.$0;bF.Dirty?(bF.Text.nodeValue=bF.Value,bF.Dirty=false):void 0;}else if(bE!=null&&bE.$==6){bG=bE.$0;B.iter(function(bH){P.SyncElemNode(false,bH);},bG.Holes);B.iter(function(bH){z.Sync(bH[0],bH[1]);},bG.Attrs);P.AfterRender(bG);}else{P.Sync(bE.$0);P.Sync(bE.$1);}};P.AfterRender=function(bE){var bF;bF=bA.GetOptional(bE.Render);bF!=null&&bF.$==1?(bF.$0(bE.El),bA.SetOptional(bE,"Render",null)):void 0;};P.DoSyncElement=function(bE){var bF,bG,bH;function bI(bJ,bK){var bL,bM;return bJ!=null&&bJ.$==1?bJ.$0.El:bJ!=null&&bJ.$==2?(bL=bJ.$0,bL.Dirty?(bL.Dirty=false,P.InsertDoc(bF,bL.Current,bK)):bI(bL.Current,bK)):bJ==null?bK:bJ!=null&&bJ.$==4?bJ.$0.Text:bJ!=null&&bJ.$==5?bJ.$0:bJ!=null&&bJ.$==6?(bM=bJ.$0,(bM.Dirty?bM.Dirty=false:void 0,B.foldBack(function(bN,bO){return bN==null||bN.constructor===T?bI(bN,bO):bN;},bM.Els,bK))):bI(bJ.$0,bI(bJ.$1,bK));}bF=bE.El;bn.Iter((bG=bE.El,function(bJ){y.RemoveNode(bG,bJ);}),bn.Except(bn.DocChildren(bE),bn.Children(bE.El,bA.GetOptional(bE.Delimiters))));bI(bE.Children,(bH=bA.GetOptional(bE.Delimiters),bH!=null&&bH.$==1?bH.$0[1]:null));};Q=f.DocElemNode=bA.Class({Equals:function(bE){return this.ElKey===bE.ElKey;},GetHashCode:function(){return this.ElKey;}},null,Q);Q.New=function(bE,bF,bG,bH,bI,bJ){var bK;return new Q((bK={Attr:bE,Children:bF,El:bH,ElKey:bI},(bA.SetOptional(bK,"Delimiters",bG),bA.SetOptional(bK,"Render",bJ),bK)));};S=f.Updates=bA.Class({},null,S);S.Create=function(bE){var bF;bF=null;bF=S.New(bE,null,function(){var bG;bG=bF.s;return bG===null?(bG=K.Copy(bF.c()),bF.s=bG,K.WhenObsoleteRun(bG,function(){bF.s=null;}),bG):bG;});return bF;};S.New=function(bE,bF,bG){return new S({c:bE,s:bF,v:bG});};B.ofList=function(bE){var bF,bG;bG=[];bF=bE;while(!(bF.$==0)){bG.push(s.head(bF));bF=s.tail(bF);}return bG;};B.exists=function(bE,bF){var bG,bH,bI,bJ;bG=false;bH=0;bJ=B.length(bF);while(!bG&&bH<bJ)if(bE(bF[bH]))bG=true;else bH=bH+1;return bG;};B.tryPick=function(bE,bF){var bG,bH,bI;bG=null;bH=0;while(bH<bF.length&&bG==null){bI=bE(bF[bH]);bI!=null&&bI.$==1?bG=bI:void 0;bH=bH+1;}return bG;};B.tryFindIndex=function(bE,bF){var bG,bH;bG=null;bH=0;while(bH<bF.length&&bG==null){bE(bF[bH])?bG={$:1,$0:bH}:void 0;bH=bH+1;}return bG;};B.filter=function(bE,bF){var bG,bH,bI;bG=[];for(bH=0,bI=bF.length-1;bH<=bI;bH++)if(bE(bF[bH]))bG.push(bF[bH]);return bG;};B.map=function(bE,bF){var bG,bH,bI;bG=new a.Array(bF.length);for(bH=0,bI=bF.length-1;bH<=bI;bH++)bG[bH]=bE(bF[bH]);return bG;};B.iter=function(bE,bF){var bG,bH;for(bG=0,bH=bF.length-1;bG<=bH;bG++)bE(bF[bG]);};B.foldBack=function(bE,bF,bG){var bH,bI,bJ,bK,bL;bH=bG;bJ=bF.length;for(bK=1,bL=bJ;bK<=bL;bK++)bH=bE(bF[bJ-bK],bH);return bH;};B.pick=function(bE,bF){var bG;bG=B.tryPick(bE,bF);return bG==null?i.FailWith("KeyNotFoundException"):bG.$0;};B.concat=function(bE){return a.Array.prototype.concat.apply([],B.ofSeq(bE));};B.ofSeq=function(bE){var bF,bG;if(bE instanceof a.Array)return bE.slice();else if(bE instanceof A)return B.ofList(bE);else{bF=[];bG=J.Get(bE);try{while(bG.MoveNext())bF.push(bG.Current());return bF;}finally{if(typeof bG=="object"&&"Dispose"in bG)bG.Dispose();}}};B.choose=function(bE,bF){var bG,bH,bI,bJ;bG=[];for(bH=0,bI=bF.length-1;bH<=bI;bH++){bJ=bE(bF[bH]);bJ==null?void 0:bG.push(bJ.$0);}return bG;};B.create=function(bE,bF){var bG,bH,bI;bG=new a.Array(bE);for(bH=0,bI=bE-1;bH<=bI;bH++)bG[bH]=bF;return bG;};B.init=function(bE,bF){var bG,bH,bI;bE<0?i.FailWith("Negative size given."):null;bG=new a.Array(bE);for(bH=0,bI=bE-1;bH<=bI;bH++)bG[bH]=bF(bH);return bG;};B.forall=function(bE,bF){var bG,bH,bI,bJ;bG=true;bH=0;bJ=B.length(bF);while(bG&&bH<bJ)if(bE(bF[bH]))bH=bH+1;else bG=false;return bG;};U.notPresent=function(){return i.FailWith("The given key was not present in the dictionary.");};V.convertTextNode=function(bE){var bF,bG,bH,bI,bJ,bK;bF=null;bG=0;bI=bE.textContent;bJ=new a.RegExp(x.TextHoleRE(),"g");while(bF=bJ.exec(bI),bF!==null){bE.parentNode.insertBefore(self.document.createTextNode(W.string(bI,{$:1,$0:bG},{$:1,$0:bJ.lastIndex-B.get(bF,0).length-1})),bE);bG=bJ.lastIndex;bK=self.document.createElement("span");bK.setAttribute("ws-replace",B.get(bF,1).toLowerCase());bE.parentNode.insertBefore(bK,bE);}bJ.lastIndex=0;bE.textContent=W.string(bI,{$:1,$0:bG},null);};V.failNotLoaded=function(bE){bB.warn("Instantiating non-loaded template",bE);};V.fillTextHole=function(bE,bF,bG){var bH;bH=bE.querySelector("[ws-replace]");return t.Equals(bH,null)?(bB.warn("Filling non-existent text hole",bG),null):(bH.parentNode.replaceChild(new a.Text(bF),bH),{$:1,$0:bH.getAttribute("ws-replace")});};V.removeHolesExcept=function(bE,bF){function bG(bH){y.IterSelector(bE,"["+bH+"]",function(bI){if(!bF.Contains(bI.getAttribute(bH)))bI.removeAttribute(bH);});}bG("ws-attr");bG("ws-onafterrender");bG("ws-var");y.IterSelector(bE,"[ws-hole]",function(bH){if(!bF.Contains(bH.getAttribute("ws-hole"))){bH.removeAttribute("ws-hole");while(bH.hasChildNodes())bH.removeChild(bH.lastChild);}});y.IterSelector(bE,"[ws-replace]",function(bH){if(!bF.Contains(bH.getAttribute("ws-replace")))bH.parentNode.removeChild(bH);});y.IterSelector(bE,"[ws-on]",function(bH){bH.setAttribute("ws-on",_7.concat(" ",B.filter(function(bI){return bF.Contains(B.get(_7.SplitChars(bI,[":"],1),1));},_7.SplitChars(bH.getAttribute("ws-on"),[" "],1))));});y.IterSelector(bE,"[ws-attr-holes]",function(bH){var bI,bJ,bK,bL,bM;bI=_7.SplitChars(bH.getAttribute("ws-attr-holes"),[" "],1);for(bJ=0,bK=bI.length-1;bJ<=bK;bJ++){bL=B.get(bI,bJ);bH.setAttribute(bL,(bM=new a.RegExp(x.TextHoleRE(),"g"),bH.getAttribute(bL).replace(bM,function(bN,bO){return bF.Contains(bO)?bN:"";})));}});};V.fillInstanceAttrs=function(bE,bF){var bG,bH,bI,bJ,bK;V.convertAttrs(bF);bG=bF.nodeName.toLowerCase();bH=bE.querySelector("[ws-attr="+bG+"]");if(t.Equals(bH,null))bB.warn("Filling non-existent attr hole",bG);else{bH.removeAttribute("ws-attr");for(bI=0,bJ=bF.attributes.length-1;bI<=bJ;bI++){bK=bF.attributes.item(bI);bK.name==="class"&&bH.hasAttribute("class")?bH.setAttribute("class",bH.getAttribute("class")+" "+bK.nodeValue):bH.setAttribute(bK.name,bK.nodeValue);}}};V.mapHoles=function(bE,bF){function bG(bH){y.IterSelector(bE,"["+bH+"]",function(bI){var bJ,bK;bJ=(bK=null,[bF.TryGetValue(bI.getAttribute(bH).toLowerCase(),{get:function(){return bK;},set:function(bL){bK=bL;}}),bK]);bJ[0]?bI.setAttribute(bH,bJ[1]):void 0;});}bG("ws-hole");bG("ws-replace");bG("ws-attr");bG("ws-onafterrender");bG("ws-var");y.IterSelector(bE,"[ws-on]",function(bH){bH.setAttribute("ws-on",_7.concat(" ",B.map(function(bI){var bJ,bK,bL;bJ=_7.SplitChars(bI,[":"],1);bK=(bL=null,[bF.TryGetValue(B.get(bJ,1),{get:function(){return bL;},set:function(bM){bL=bM;}}),bL]);return bK[0]?B.get(bJ,0)+":"+bK[1]:bI;},_7.SplitChars(bH.getAttribute("ws-on"),[" "],1))));});y.IterSelector(bE,"[ws-attr-holes]",function(bH){var bI,bJ,bK;bI=_7.SplitChars(bH.getAttribute("ws-attr-holes"),[" "],1);for(bJ=0,bK=bI.length-1;bJ<=bK;bJ++)(function(){var bL;function bM(bN,bO){var bP;bP=i.KeyValue(bO);return bN.replace(new a.RegExp("\\${"+bP[0]+"}","ig"),"${"+bP[1]+"}");}bL=B.get(bI,bJ);return bH.setAttribute(bL,(((bA.Curried3(C.fold))(bM))(bH.getAttribute(bL)))(bF));}());});};V.fill=function(bE,bF,bG){while(true)if(bE.hasChildNodes())bG=bF.insertBefore(bE.lastChild,bG);else return null;};V.convertAttrs=function(bE){var bG,bH,bI,bJ,bK,bL,bM,bN;function bF(bO){var bP;bP=bE.getAttribute(bO);bP===null?void 0:bE.setAttribute(bO,bP.toLowerCase());}bG=bE.attributes;bH=[];bI=[];bJ=[];for(bK=0,bL=bG.length-1;bK<=bL;bK++){bM=bG.item(bK);_7.StartsWith(bM.nodeName,"ws-on")&&bM.nodeName!=="ws-onafterrender"&&bM.nodeName!=="ws-on"?(bH.push(bM.nodeName),bI.push(W.string(bM.nodeName,{$:1,$0:"ws-on".length},null)+":"+bM.nodeValue.toLowerCase())):!_7.StartsWith(bM.nodeName,"ws-")&&(new a.RegExp(x.TextHoleRE())).test(bM.nodeValue)?(bM.nodeValue=(bN=new a.RegExp(x.TextHoleRE(),"g"),bM.nodeValue.replace(bN,function(bO,bP){return"${"+bP.toLowerCase()+"}";})),bJ.push(bM.nodeName)):void 0;}!(bI.length==0)?bE.setAttribute("ws-on",_7.concat(" ",bI)):void 0;!(bJ.length==0)?bE.setAttribute("ws-attr-holes",_7.concat(" ",bJ)):void 0;bF("ws-hole");bF("ws-replace");bF("ws-attr");bF("ws-onafterrender");bF("ws-var");B.iter(function(bO){bE.removeAttribute(bO);},bH);};W.string=function(bE,bF,bG){return bF==null?bG!=null&&bG.$==1?bE.slice(0,bG.$0+1):"":bG==null?bE.slice(bF.$0):bE.slice(bF.$0,bG.$0+1);};C.insufficient=function(){return i.FailWith("The input sequence has an insufficient number of elements.");};X=F.KeyCollection=bA.Class({GetEnumerator$1:function(){return J.Get(C.map(function(bE){return bE.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},e,X);X.New=bA.Ctor(function(bE){e.New.call(this);this.d=bE;},X);Y.get_UseAnimations=function(){return $.UseAnimations();};Y.Play=function(bE){var bF;bF=null;return bc.Delay(function(){return bc.Bind(Y.Run(a.ignore,$.Actions(bE)),function(){$.Finalize(bE);return bc.Return(null);});});};Y.Append=function(bE,bF){return{$:0,$0:bd.Append(bE.$0,bF.$0)};};Y.Run=function(bE,bF){var bG;function bH(bI){function bJ(bK,bL){var bM;bM=bL-bK;bF.Compute(bM);bE();return bM<=bG?void a.requestAnimationFrame(function(bN){bJ(bK,bN);}):bI();}a.requestAnimationFrame(function(bK){bJ(bK,bK);});}bG=bF.Duration;return bG===0?bc.Zero():bc.FromContinuations(function(bI,bJ,bK){return bH.apply(null,[bI,bJ,bK]);});};Y.Concat=function(bE){return{$:0,$0:bd.Concat(C.map($.List,bE))};};Z.BatchUpdatesEnabled=function(){ba.$cctor();return ba.BatchUpdatesEnabled;};_1.StartProcessor=function(bE){var bF;function bG(){var bH;bH=null;return bc.Delay(function(){return bc.Bind(bE,function(){var bI;bI=bF[0];return bI===1?(bF[0]=0,bc.Zero()):bI===2?(bF[0]=1,bG()):bc.Zero();});});}bF=[0];return function(){var bH;bH=bF[0];bH===0?(bF[0]=1,bc.Start(bG(),null)):bH===1?bF[0]=2:void 0;};};_3.New=function(bE,bF,bG,bH){var bI;bI={DynElem:bE,DynFlags:bF,DynNodes:bG};bA.SetOptional(bI,"OnAfterRender",bH);return bI;};_4.Int=function(){_4.set_counter(_4.counter()+1);return _4.counter();};_4.set_counter=function(bE){bf.$cctor();bf.counter=bE;};_4.counter=function(){bf.$cctor();return bf.counter;};_5.$cctor=function(){_5.$cctor=a.ignore;_5.EmptyAttr=null;};_6=J.T=bA.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},e,_6);_6.New=bA.Ctor(function(bE,bF,bG,bH){e.New.call(this);this.s=bE;this.c=bF;this.n=bG;this.d=bH;},_6);K.Obsolete=function(bE){var bF,bG,bH,bI,bJ;bG=bE.s;if(bG==null||(bG!=null&&bG.$==2?(bF=bG.$1,false):bG!=null&&bG.$==3?(bF=bG.$1,false):true))void 0;else{bE.s=null;for(bH=0,bI=B.length(bF)-1;bH<=bI;bH++){bJ=B.get(bF,bH);typeof bJ=="object"?function(bK){K.Obsolete(bK);}(bJ):bJ();}}};K.New=function(bE){return{s:bE};};_7.concat=function(bE,bF){return B.ofSeq(bF).join(bE);};_7.SplitChars=function(bE,bF,bG){return _7.Split(bE,new a.RegExp("["+_7.RegexEscape(bF.join(""))+"]"),bG);};_7.StartsWith=function(bE,bF){return bE.substring(0,bF.length)==bF;};_7.Split=function(bE,bF,bG){return bG===1?B.filter(function(bH){return bH!=="";},_7.SplitWith(bE,bF)):_7.SplitWith(bE,bF);};_7.RegexEscape=function(bE){return bE.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};_7.SplitWith=function(bE,bF){return bE.split(bF);};_9.New=function(bE,bF){return{PreviousNodes:bE,Top:bF};};_.get_Empty=function(){return{$:0,$0:new M.New$3()};};_.FindAll=function(bE){var bF;function bG(bI){if(bI!=null&&bI.$==0){bG(bI.$0);bG(bI.$1);}else if(bI!=null&&bI.$==1)bH(bI.$0);else if(bI!=null&&bI.$==2)bG(bI.$0.Current);else if(bI!=null&&bI.$==6)B.iter(bH,bI.$0.Holes);}function bH(bI){bF.push(bI);bG(bI.Children);}bF=[];bG(bE);return{$:0,$0:new M.New$2(bF)};};_.Filter=function(bE,bF){return{$:0,$0:bk.Filter(bE,bF.$0)};};_.Except=function(bE,bF){return{$:0,$0:bk.Except(bE.$0,bF.$0)};};_.ToArray=function(bE){return bk.ToArray(bE.$0);};_.Intersect=function(bE,bF){return{$:0,$0:bk.Intersect(bE.$0,bF.$0)};};$.UseAnimations=function(){bb.$cctor();return bb.UseAnimations;};$.Actions=function(bE){return $.ConcatActions(B.choose(function(bF){return bF.$==1?{$:1,$0:bF.$0}:null;},bd.ToArray(bE.$0)));};$.Finalize=function(bE){B.iter(function(bF){if(bF.$==0)bF.$0();},bd.ToArray(bE.$0));};$.ConcatActions=function(bE){var bF,bG,bH,bI;bF=I.ofSeqNonCopying(bE);bG=B.length(bF);return bG===0?$.Const():bG===1?B.get(bF,0):(bH=C.max(C.map(function(bJ){return bJ.Duration;},bF)),(bI=B.map(function(bJ){return $.Prolong(bH,bJ);},bF),$.Def(bH,function(bJ){B.iter(function(bK){bK.Compute(bJ);},bI);})));};$.List=function(bE){return bE.$0;};$.Const=function(bE){return $.Def(0,function(){return bE;});};$.Def=function(bE,bF){return{Compute:bF,Duration:bE};};$.Prolong=function(bE,bF){var bG,bH,bI;bG=bF.Compute;bH=bF.Duration;bI=br.Create(function(){return bF.Compute(bF.Duration);});return{Compute:function(bJ){return bJ>=bH?bI.f():bG(bJ);},Duration:bE};};ba.$cctor=function(){ba.$cctor=a.ignore;ba.BatchUpdatesEnabled=true;};bb.$cctor=function(){bb.$cctor=a.ignore;bb.CubicInOut=bg.Custom(function(bE){var bF;bF=bE*bE;return 3*bF-2*(bF*bE);});bb.UseAnimations=true;};bc.Delay=function(bE){return function(bF){try{(bE(null))(bF);}catch(bG){bF.k({$:1,$0:bG});}};};bc.Bind=function(bE,bF){return bc.checkCancel(function(bG){bE(bh.New(function(bH){var bI;if(bH.$==0){bI=bH.$0;bc.scheduler().Fork(function(){try{(bF(bI))(bG);}catch(bJ){bG.k({$:1,$0:bJ});}});}else bc.scheduler().Fork(function(){bG.k(bH);});},bG.ct));});};bc.Zero=function(){bi.$cctor();return bi.Zero;};bc.Start=function(bE,bF){var bG,bH;bG=(bH=(bc.defCTS())[0],bF==null?bH:bF.$0);bc.scheduler().Fork(function(){if(!bG.c)bE(bh.New(function(bI){if(bI.$==1)bc.UncaughtAsyncError(bI.$0);},bG));});};bc.Return=function(bE){return function(bF){bF.k({$:0,$0:bE});};};bc.checkCancel=function(bE){return function(bF){if(bF.ct.c)bc.cancel(bF);else bE(bF);};};bc.defCTS=function(){bi.$cctor();return bi.defCTS;};bc.UncaughtAsyncError=function(bE){bB.log("WebSharper: Uncaught asynchronous exception",bE);};bc.FromContinuations=function(bE){return function(bF){var bG;function bH(bI){if(bG[0])i.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bG[0]=true;bc.scheduler().Fork(bI);}}bG=[false];bE(function(bI){bH(function(){bF.k({$:0,$0:bI});});},function(bI){bH(function(){bF.k({$:1,$0:bI});});},function(bI){bH(function(){bF.k({$:2,$0:bI});});});};};bc.cancel=function(bE){bE.k({$:2,$0:new bq.New(bE.ct)});};bc.scheduler=function(){bi.$cctor();return bi.scheduler;};bd.Append=function(bE,bF){return bE.$==0?bF:bF.$==0?bE:{$:2,$0:bE,$1:bF};};bd.ToArray=function(bE){var bF;function bG(bH){if(bH.$==1)bF.push(bH.$0);else if(bH.$==2){bG(bH.$0);bG(bH.$1);}else if(bH.$==3)B.iter(function(bI){bF.push(bI);},bH.$0);}bF=[];bG(bE);return bF.slice(0);};bd.Concat=function(bE){var bF;bF=I.ofSeqNonCopying(bE);return I.TreeReduce(bd.Empty(),bd.Append,bF);};bd.Empty=function(){bs.$cctor();return bs.Empty;};be.concat=function(bE){var bF,bG;bF=[];for(var bH in bE)bF.push.apply(bF,bE[bH]);return bF;};bf.$cctor=function(){bf.$cctor=a.ignore;bf.counter=0;};bg=f.Easing=bA.Class({},e,bg);bg.Custom=function(bE){return new bg.New(bE);};bg.New=bA.Ctor(function(bE){e.New.call(this);this.transformTime=bE;},bg);bh.New=function(bE,bF){return{k:bE,ct:bF};};bi.$cctor=function(){bi.$cctor=a.ignore;bi.noneCT=bj.New(false,[]);bi.scheduler=new bl.New();bi.defCTS=[new bm.New()];bi.Zero=bc.Return();bi.GetCT=function(bE){bE.k({$:0,$0:bE.ct});};};bj.New=function(bE,bF){return{c:bE,r:bF};};bk.Filter=function(bE,bF){return new M.New$2(B.filter(bE,bk.ToArray(bF)));};bk.Except=function(bE,bF){var bG;bG=new M.New$2(bk.ToArray(bF));bG.ExceptWith(bk.ToArray(bE));return bG;};bk.ToArray=function(bE){var bF;bF=B.create(bE.get_Count(),void 0);bE.CopyTo(bF);return bF;};bk.Intersect=function(bE,bF){var bG;bG=new M.New$2(bk.ToArray(bE));bG.IntersectWith(bk.ToArray(bF));return bG;};bl=bc.Scheduler=bA.Class({Fork:function(bE){var bF;bF=this;this.robin.push(bE);this.idle?(this.idle=false,a.setTimeout(function(){bF.tick();},0)):void 0;},tick:function(){var bE,bF,bG;bF=this;bG=bD.now();bE=true;while(bE)if(this.robin.length===0){this.idle=true;bE=false;}else{(this.robin.shift())();bD.now()-bG>40?(a.setTimeout(function(){bF.tick();},0),bE=false):void 0;}}},e,bl);bl.New=bA.Ctor(function(){e.New.call(this);this.idle=true;this.robin=[];},bl);bm=d.CancellationTokenSource=bA.Class({},e,bm);bm.New=bA.Ctor(function(){e.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bm);bn.Children=function(bE,bF){var bG,bH,bI;if(bF!=null&&bF.$==1){bI=[];bG=bF.$0[0].nextSibling;while(bG!==bF.$0[1]){bI.push(bG);bG=bG.nextSibling;}return{$:0,$0:bI};}else return{$:0,$0:B.init(bE.childNodes.length,(bH=bE.childNodes,function(bJ){return bH[bJ];}))};};bn.Except=function(bE,bF){var bG;bG=bE.$0;return{$:0,$0:B.filter(function(bH){return B.forall(function(bI){return!(bH===bI);},bG);},bF.$0)};};bn.Iter=function(bE,bF){B.iter(bE,bF.$0);};bn.DocChildren=function(bE){var bF;function bG(bH){if(bH!=null&&bH.$==2)bG(bH.$0.Current);else if(bH!=null&&bH.$==1)bF.push(bH.$0.El);else if(bH==null);else if(bH!=null&&bH.$==5)bF.push(bH.$0);else if(bH!=null&&bH.$==4)bF.push(bH.$0.Text);else if(bH!=null&&bH.$==6)B.iter(function(bI){if(bI==null||bI.constructor===T)bG(bI);else bF.push(bI);},bH.$0.Els);else{bG(bH.$0);bG(bH.$1);}}bF=[];bG(bE.Children);return{$:0,$0:I.ofSeqNonCopying(bF)};};bo.Clear=function(bE){bE.splice(0,B.length(bE));};bq=d.OperationCanceledException=bA.Class({},bp,bq);bq.New=bA.Ctor(function(bE){bq.New$1.call(this,"The operation was canceled.",null,bE);},bq);bq.New$1=bA.Ctor(function(bE,bF,bG){this.message=bE;this.inner=bF;T.setPrototypeOf(this,bq.prototype);this.ct=bG;},bq);br.Create=function(bE){return bu.New(false,bE,br.forceLazy);};br.forceLazy=function(){var bE;bE=this.v();this.c=true;this.v=bE;this.f=br.cachedLazy;return bE;};br.cachedLazy=function(){return this.v;};bs.$cctor=function(){bs.$cctor=a.ignore;bs.Empty={$:0};};bu.New=function(bE,bF,bG){return{c:bE,v:bF,f:bG};};bA.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
